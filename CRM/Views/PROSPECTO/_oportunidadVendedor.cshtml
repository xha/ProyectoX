

@model CRM.Models.PROSPECTO

@{
    List<CRM.Models.Maecli_campos> ListaCLIENTEFI;
    List<CRM.Models.Potencial_campos> ListaCLIENTEPOT;
    List<CRM.Models.CONTACTO_VENTA> ContactoFI;
    List<CRM.Models.CONTACTO_POTENCIAL> ContactoPOT;
    List<CRM.Models.TIPO_ACTIVIDAD> tIPO_ACTIVIDAD = ViewBag.tIPO_ACTIVIDAD;

    ViewBag.Title = "Editar";
}


    <div id="cuerpo" class="container-fluid">
        <section class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-8 mb-2">
                        <h1>
                            Oportunidad

                            @if (Model.id_estatusProspecto == 1)
                            {

                                <span id="EstatusOportunidad" class="info-box-icon elevation-3 ml-0 ml-sm-2 ml-lg-5 p-1 text-uppercase text-black-50 text-bold" style="background: @Model.ESTATUS_PROSPECTO.color ;border-radius: 6px;">@Model.ESTATUS_PROSPECTO.descripcion</span>
                            }
                            else
                            {
                                <span id="EstatusOportunidad" class="info-box-icon elevation-3 ml-0 ml-sm-2 ml-lg-5 p-1 text-uppercase text-white text-bold" style="background: @Model.ESTATUS_PROSPECTO.color ;border-radius: 6px;">@Model.ESTATUS_PROSPECTO.descripcion</span>
                            }


                        </h1>
                    </div>
                    <div class="col-sm-4">
                        <ol class="breadcrumb float-sm-right">
                            <li class="breadcrumb-item"><a href="@Url.Action("index", "Flujo")">Flujo</a></li>
                            <li class="breadcrumb-item active">Oportunidad</li>
                        </ol>
                    </div>
                </div>
            </div><!-- /.container-fluid -->
        </section>





        <!-- Main content -->

        <section class="content">
            <div class="row mb-2 text-center text-sm-left ml-0 ml-sm-2">

                @if (Model.id_estatusProspecto == 1)
                {
                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 2, idProspecto = Model.id_oportunidad })" id="archivar" class="btn w-auto text-white text-bold " style="background: #3c8dbc" title="archivar">
                            ARCHIVAR <i class="fas fa-archive"></i>
                        </a>
                    </div>
                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 3, idProspecto = Model.id_oportunidad })" id="ganado" class="btn text-white w-auto text-bold " style="background: #28a745" title="ganado">
                            GANADO <i class="fas fa-sun"></i>
                        </a>
                    </div>

                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 4, idProspecto = Model.id_oportunidad })" id="perdido" class="btn text-white w-auto text-bold " style="background: #dc3545" title="perdido">
                            PERDIDO <i class="fas fa-cloud-showers-heavy"></i>
                        </a>
                    </div>

                }
                @if (Model.id_estatusProspecto == 2)
                {
                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 1, idProspecto = Model.id_oportunidad })" id="flujo" class="btn text-black-50 w-auto text-bold " style="background: #fff" title="flujo">
                            FLUJO <i class="fas fa-project-diagram"></i>
                        </a>
                    </div>

                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 3, idProspecto = Model.id_oportunidad })" id="ganado" class="btn text-white w-auto text-bold " style="background: #28a745" title="ganado">
                            GANADO <i class="fas fa-sun"></i>
                        </a>
                    </div>

                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 4, idProspecto = Model.id_oportunidad })" id="perdido" class="btn text-white w-auto text-bold " style="background: #dc3545" title="perdido">
                            PERDIDO <i class="fas fa-cloud-showers-heavy"></i>
                        </a>
                    </div>

                }
                @if (Model.id_estatusProspecto == 3)
                {
                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 1, idProspecto = Model.id_oportunidad })" id="flujo" class="btn text-black-50 w-auto text-bold " style="background: #fff" title="flujo">
                            FLUJO <i class="fas fa-project-diagram"></i>
                        </a>
                    </div>

                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 2, idProspecto = Model.id_oportunidad })" id="archivar" class="btn text-white w-auto text-bold " style="background: #3c8dbc" title="archivar">
                            ARCHIVAR <i class="fas fa-archive"></i>
                        </a>
                    </div>

                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 4, idProspecto = Model.id_oportunidad })" id="perdido" class="btn text-white w-auto text-bold " style="background: #dc3545" title="perdido">
                            PERDIDO <i class="fas fa-cloud-showers-heavy"></i>
                        </a>
                    </div>

                }
                @if (Model.id_estatusProspecto == 4)
                {
                    <div class="col-12 col-sm-auto mb-2 mb-sm-0 p-0 p-sm-2">
                        <a href="@Url.Action("cambiarEstatus", "PROSPECTO", new { estatusFinal = 1, idProspecto = Model.id_oportunidad })" id="flujo" class="btn text-black-50 w-auto text-bold " style="background: #fff" title="flujo">
                            RESTAURAR AL FLUJO <i class="fas fa-project-diagram"></i>
                        </a>
                    </div>

                }


            </div>
            <div class="row">
                <div class="col-12 col-md-12 col-lg-8 order-2 order-md-1" id="ProAct">
                    <div class="card">
                        @using (Html.BeginForm("GuardarEditar", "PROSPECTO", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            @Html.AntiForgeryToken()
                            <input type="hidden" class="form-control form-control-lg mw-75" name="idProspecto" value="@Model.id_oportunidad">
                            <div class="card-header" style="background: @Model.ESTATUS_PROSPECTO.color">
                                <div class="row mb-3">
                                    <div class="col-12 col-sm-8 align-self-center">
                                        @if (Model.id_estatusProspecto == 1)
                                        {
                                            <h3 class="text-black-50 align-middle dato mb-0">
                                                <i class="fas fa-briefcase"></i> @Model.nombre


                                            </h3>
                                        }
                                        else
                                        {
                                            <h3 class="text-white align-middle dato mb-0">
                                                <i class="fas fa-briefcase"></i> @Model.nombre


                                            </h3>
                                        }

                                        <input type="hidden" class="info-prospecto form-control form-control-lg mw-75" name="nombreOp" datoAnt="@Model.nombre" value="@Model.nombre">

                                    </div>
                                    <div id="listaEstado" class="col-12 col-sm-4 align-self-center ">
                                        @Html.DropDownList("Estado", ViewBag.id_estadoOporunidad as SelectList, null, htmlAttributes: new { @class = "select2 form-control mw-100 ", @urlRetorno = Url.Action("editar", "PROSPECTO", new { id = Model.id_oportunidad, tipoCli = Model.tipoCliente, cliente = Model.idCliente }) })
                                        <input type="hidden" class="form-control mw-75" id="COD_CONTACTO" name="estadoActual" value="@Model.id_estadoOporunidad">
                                    </div>
                                </div>

                            </div>
                            <div class="card-body">


                                <div class="row">

                                    <div class="col-12 col-md-4">
                                        <div class="info-box">
                                            <span class="info-box-icon bg-success elevation-2"><i class="fas fa-funnel-dollar"></i></span>

                                            <div class="info-box-content">
                                                <h4 class="info-box-text">Ingreso</h4>
                                                <h5 class="info-box-number dato text-md">

                                                    <span>@Model.TIPO_MONEDA.TIPOMON_SIMBOLO</span>
                                                    <span>@Model.ingreso</span>
                                                </h5>
                                                <div class="row justify-content-around">
                                                    <div class="col-4">
                                                        @Html.DropDownList("tipoMoneda", ViewBag.ListaTipoMoneda as SelectList, null, htmlAttributes: new { @class = "info-prospecto form-control mw-100  hidden", @required = "required", @datoAnt = "" })

                                                    </div>
                                                    <div class="col-7">
                                                        <input type="number" class="info-prospecto form-control mw-75 hidden" id="COD_CONTACTO" name="Ingreso" step="0.01" datoAnt="@Model.ingreso" value="@Model.ingreso">

                                                    </div>

                                                </div>

                                            </div>
                                            <!-- /.info-box-content -->
                                        </div>

                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="info-box mb-3">
                                            <span class="info-box-icon bg-danger elevation-2"><i class="fas fa-calendar-day"></i></span>

                                            <div class="info-box-content">
                                                <h4 class="info-box-text">Cierre del plan</h4>

                                                <h5 class="info-box-number cierreEstimado text-md">No especificado</h5>


                                            </div>
                                            <!-- /.info-box-content -->
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="info-box mb-3">
                                            <span class="info-box-icon bg-info elevation-2"><i class="fas fa-bullseye"></i></span>


                                            <div class="info-box-content">
                                                <h4 class="info-box-text">Probabilidad</h4>
                                                <h5 class="info-box-number dato text-md">
                                                    <span>@Model.porcentajeGanar</span>
                                                    <span>%</span>
                                                </h5>
                                                <div id="probabilidad" class="hidden">
                                                    <input class="info-prospecto" type="hidden" id="range_5" name="probabilidad" value="@Model.porcentajeGanar">
                                                </div>


                                            </div>


                                            <!-- /.info-box-content -->
                                        </div>
                                    </div>
                                </div>



                                <div class="row justify-content-around">
                                    <div class="col-12 col-md-6 pr-0 pr-md-5">
                                        <div id="cliente" class="text-muted">
                                            @if (ViewBag.clientePot == null)
                                            {
                                                ListaCLIENTEFI = ViewBag.clienteFi;
                                                ContactoFI = ViewBag.contactoFi;
                                                foreach (var CLIENTEFI in ListaCLIENTEFI)
                                                {
                                                    <p class="text-lg">
                                                        Cliente <i class="fas fa-user"></i>
                                                        <b id="CNOMCLI" class="d-block">@CLIENTEFI.CNOMCLI <a href="#" id="modeditarClienteFi" class="fas fa-edit" data-toggle="modal" data-target="#modal_editarClienteFi" value="" name="accion:Editar" style="background: #fff;"></a></b>
                                                    </p>
                                                    <div class="media mediaCliente">
                                                        @if (CLIENTEFI.CTELEFO != "")
                                                        {
                                                            <a class="text-success text-md mr-3"><i alt="LLamada" class="img-circle text-center mt-auto mb-auto img-circle fas fa-phone-alt"></i> @CLIENTEFI.CTELEFO</a>
                                                        }

                                                        @if (CLIENTEFI.CEMAIL != "")
                                                        {
                                                            <a class="text-md"><i alt="Correo" class="img-circle text-center  mt-auto mb-auto img-circle far fa-envelope"></i> @CLIENTEFI.CEMAIL</a>
                                                        }

                                                    </div>
                                                    if (ViewBag.contactoFi == null)
                                                    {

                                                    }
                                                    else
                                                    {

                                                        <p class="text-lg mt-3">
                                                            Contactos del cliente

                                                        </p>
                                                        <div id="Contacto" class="row text-cente flex-row flex-nowrap ">

                                                            <div class="col-12  table-responsive">

                                                                <table id="@CLIENTEFI.CCODCLI" tipoCliente="1" class="table table-sm table-bordered">
                                                                    <thead>
                                                                        <tr>

                                                                            <th>
                                                                                Contacto
                                                                            </th>

                                                                            <th>
                                                                                Correo
                                                                            </th>
                                                                            <th>
                                                                                Teléfono
                                                                            </th>
                                                                            <th>
                                                                                Celular
                                                                            </th>

                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @foreach (var cONTACTO in ContactoFI)
                                                                        {
                                                                            <tr id="guardado">
                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.CONTACTO)</p>

                                                                                </td>

                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.CORREO)</p>

                                                                                </td>
                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.TELEFONO)</p>

                                                                                </td>
                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.CELULAR)</p>

                                                                                </td>
                                                                            </tr>
                                                                        }
                                                                    </tbody>
                                                                </table>

                                                            </div>
                                                        </div>

                                                    }
                                                }



                                            }
                                            else
                                            {
                                                ListaCLIENTEPOT = ViewBag.clientePot;
                                                ContactoPOT = ViewBag.contactoPot;
                                                foreach (var CLIENTEPOT in ListaCLIENTEPOT)
                                                {
                                                    <p class="text-lg">
                                                        Prospecto <i class="far fa-user"></i>
                                                        <b class="d-block">@CLIENTEPOT.CNOMCLI <a href="#" id="modeditarClientePot" class="fas fa-edit" data-toggle="modal" data-target="#modal_editarClientePot" value="" name="accion:Editar" style="background: #fff;"></a></b>
                                                    </p>
                                                    <div class="media ">
                                                        @if (CLIENTEPOT.CTELEFO != "")
                                                        {
                                                            <a class="text-success text-md mr-3"><i alt="LLamada" class="img-circle text-center mt-auto mb-auto img-circle fas fa-phone-alt"></i> @CLIENTEPOT.CTELEFO</a>
                                                        }

                                                        @if (CLIENTEPOT.CEMAIL != "")
                                                        {
                                                            <a class="text-md"><i alt="Correo" class="img-circle text-center mt-auto mb-auto img-circle far fa-envelope"></i> @CLIENTEPOT.CEMAIL</a>
                                                        }
                                                    </div>
                                                    if (ViewBag.contactoFi == null)
                                                    {

                                                    }
                                                    else
                                                    {
                                                        <p class="text-lg mt-3 text-center">
                                                            Contactos del cliente

                                                        </p>
                                                        <div id="Contacto" class="row text-cente flex-row flex-nowrap ">

                                                            <div class="col-12  table-responsive">

                                                                <table id="@CLIENTEPOT.CCODCLI" tipoCliente="0" class="table table-sm table-bordered">
                                                                    <thead>
                                                                        <tr>

                                                                            <th>
                                                                                Contacto
                                                                            </th>

                                                                            <th>
                                                                                Correo
                                                                            </th>
                                                                            <th>
                                                                                Teléfono
                                                                            </th>
                                                                            <th>
                                                                                Celular
                                                                            </th>

                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @foreach (var cONTACTO in ContactoPOT)
                                                                        {
                                                                            <tr id="guardado">
                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.CONTACTO)</p>

                                                                                </td>

                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.CORREO)</p>

                                                                                </td>
                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.TELEFONO)</p>

                                                                                </td>
                                                                                <td class="align-middle">
                                                                                    <p id="infoContacto" class="m-0">@Html.DisplayFor(modelItem => cONTACTO.CELULAR)</p>

                                                                                </td>
                                                                            </tr>
                                                                        }
                                                                    </tbody>
                                                                </table>

                                                            </div>
                                                        </div>

                                                    }
                                                }

                                            }



                                        </div>
                                        <div id="cambiarCliente" class="hidden text-lg text-muted">

                                            <div class="p-0 mb-0">
                                                <label for="Num_Op" class="usuario text-left  w-100  pl-2 mb-0"> Cliente: </label>
                                                <article class="kanban-entry" draggable="false">
                                                    <div class="kanban-entry-inner">
                                                        <div class="row justify-content-between p-2 pb-0 mb-0 m-0">
                                                            <div class="col-12  p-0 mb-0  ">
                                                                <div class="form-group">
                                                                    <div class="row">
                                                                        @if (ViewBag.clientePot == null)
                                                                        {
                                                                            <div class="col-6 text-right">
                                                                                <div class="custom-control custom-radio">
                                                                                    <input class="custom-control-input" type="radio" id="ind_radio" name="tipoContacto" required="required">
                                                                                    <label for="ind_radio" class="custom-control-label">Prospecto <i class="far fa-user"></i></label>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-6 text-left">
                                                                                <div class="custom-control custom-radio">
                                                                                    <input class="custom-control-input" type="radio" id="emp_radio" name="tipoContacto" required="required" checked>
                                                                                    <label for="emp_radio" class="custom-control-label">Fidelizado <i class="fas fa-user"></i></label>
                                                                                </div>

                                                                            </div>
                                                                        }
                                                                        else
                                                                        {
                                                                            <div class="col-6 text-right">
                                                                                <div class="custom-control custom-radio">
                                                                                    <input class="custom-control-input" type="radio" id="ind_radio" name="tipoContacto" required="required" checked>
                                                                                    <label for="ind_radio" class="custom-control-label">Prospecto <i class="far fa-user"></i></label>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-6 text-left">
                                                                                <div class="custom-control custom-radio">
                                                                                    <input class="custom-control-input" type="radio" id="emp_radio" name="tipoContacto" required="required">
                                                                                    <label for="emp_radio" class="custom-control-label">Fidelizado <i class="fas fa-user"></i></label>
                                                                                </div>

                                                                            </div>
                                                                        }


                                                                    </div>
                                                                </div>


                                                                <div class="col-12 " id="contenidoTipo">

                                                                    <input type="hidden" id="tipo" name="tipContacto" value="@Model.tipoCliente">


                                                                    <div id="potencial" class="potencial hidden">
                                                                        <div class="row justify-content-around p-0 d-flex align-items-center">



                                                                            <div class="col-8 p-0">
                                                                                <div class="form-group">

                                                                                    @Html.DropDownList("clientePot", ViewBag.listaPotencial as SelectList, "Cliente Potencial", htmlAttributes: new { @class = "form-control mw-100 select2 info-prospecto" })



                                                                                </div>

                                                                            </div>


                                                                            <a href="#" class="btn  btn-contacto w-100 p-0 font-weight-bold text-lg text-muted" data-toggle="modal" data-target="#modal_crearPotencial"><i class="fas fa-user-plus  pr-2" style="color: #0275d8"></i>Agregar Cliente</a>

                                                                        </div>
                                                                    </div>
                                                                    <div id="fidelizado" class="fidelizado hidden">
                                                                        <div class="row justify-content-around  p-0 d-flex align-items-center">


                                                                            <div class="col-8 p-0">
                                                                                <div class="form-group">

                                                                                    @Html.DropDownList("clienteFi", ViewBag.listaFidelizado as SelectList, "Cliente Fidelizado", htmlAttributes: new { @class = "form-control mw-100 select2 info-prospecto" })


                                                                                </div>

                                                                            </div>

                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </article>

                                            </div>

                                        </div>
                                    </div>
                                    <div class="col-auto col-md-6 pl-0 pl-md-5 text-left text-md-left">


                                        <p class="text-lg">
                                            Responsable la oportunidad

                                            <b class="d-block">@Model.id_usuario </b>

                                        </p>



                                        <p class="text-lg mb-0">
                                            Prioridad


                                            <div class="prioridad op_abajo_izq float-left ">
                                                @if (Model.id_prioridad == 0)
                                                {

                                                    <a href="#" onclick="return false;" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad  far fa-star" style="color: #000;"></a>
                                                    <a href="#" onclick="return false;" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad far fa-star" style="color: #000;"></a>
                                                    <a href="#" onclick="return false;" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad far fa-star" style="color: #000"></a>
                                                }

                                                @if (Model.id_prioridad == 1)
                                                {

                                                    <a href="#" onclick="return false;" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad  far fa-star" style="color: #000;"></a>
                                                    <a href="#" onclick="return false;" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad far fa-star" style="color: #000;"></a>
                                                    <a href="#" onclick="return false;" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                }
                                                @if (Model.id_prioridad == 2)
                                                {

                                                    <a href="#" onclick="return false;" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad  far fa-star" style="color: #000;"></a>
                                                    <a href="#" onclick="return false;" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                    <a href="#" onclick="return false;" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                }
                                                @if (Model.id_prioridad == 3)
                                                {

                                                    <a href="#" onclick="return false;" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                    <a href="#" onclick="return false;" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                    <a href="#" onclick="return false;" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                }

                                                <input type="hidden" id="prioridad" name="id_prioridad" class="" value="@Model.id_prioridad">

                                            </div>
                                        </p>

                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <p class="text-lg text-muted ">
                                            notas: <b class="dato">@Model.notas</b>
                                            <input type="hidden" class="info-prospecto form-control mw-75" name="notas" value="@Model.notas">

                                        </p>
                                    </div>
                                </div>
                                <div class="row text-right">
                                    <div class="col-12">
                                        <input type="submit" id="descartarCambios" value="descartar " title="guardar" class="btn btn-default hidden" />
                                        <input type="submit" id="guardarCambios" value="Guardar Cambios " title="guardar" class="btn btn-success hidden" />


                                        <button type="button" id="editarPro" class="btn btn-primary " title="Editar">
                                            Editar <i class="fas fa-pencil-alt"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>

                    @{
                        Html.RenderPartial("_Planificados");
                    }

                </div>




                <div class="col-12 col-md-12 col-lg-4 order-2 order-md-2" id="Hist">
                    <div class="card">
                        <div class="card-header">

                            <h1 class="text-primary"><i class="fas fa-history"></i> Historial de la Oportunidad</h1>
                        </div>
                        <div class="card-body historial-body">
                            <div class="row">
                                <div id="historico" class="col-12">


                                    @foreach (var Hist in Model.HISTORICO.OrderByDescending(p => p.id_historico))
                                    {
                                        <div class="post">
                                            <div class="">

                                                <span class="username ">
                                                    <a class="text-black-50 text-bold" href="#">@Hist.id_usuario </a>

                                                    @Hist.titulo


                                                </span>

                                                <p class="fecha">@Hist.fecha</p>
                                            </div>

                                        </div>
                                    }

                                </div>
                            </div>
                        </div>
                        <!-- /.card-body -->
                    </div>


                </div>


            </div>
            <!-- Default box -->
            <!-- /.card -->

        </section>

        <div class="modal fade" id="modal_crearPotencial">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Crear Prospecto</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <form role="form" class="" id="formCrearpot">
                        <div class="card card-primary card-tabs">
                            <div class="card-header navbar navbar-expand p-0 pt-1">
                                <ul class="navbar-nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="crear-tab" data-toggle="pill" href="#nuevo-cliente" role="tab" aria-controls="nuevo-cliente" aria-selected="true">Datos</a>
                                    </li>

                                    <li class="nav-item">
                                        <a class="nav-link" id="direccion-tab" data-toggle="pill" href="#nuevo-direccion" role="tab" aria-controls="nuevo-direccion" aria-selected="false">Direcciones</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="contacto-tab" data-toggle="pill" href="#nuevo-contacto" role="tab" aria-controls="nuevo-contacto" aria-selected="false">Contactos</a>
                                    </li>

                                </ul>


                            </div>

                            <div class="card-body">
                                <div class="tab-content" id="custom-tabs-one-tabContent">


                                    <div class="tab-pane fade show active" id="nuevo-cliente" role="tabpanel" aria-labelledby="nuevo-cliente">
                                        <div class="row ">
                                            <div class="col-12 ">
                                                <div class="row text-left  m-0">
                                                    <div class="col-sm-6  p-0 pr-2 mb-2  ">


                                                        <div class="form-group">
                                                            <label for="">Código del cliente:</label>
                                                            <input type="text" class="form-control form-control-sm infoCliente text-uppercase" name="CCODCLI" id="codCli">
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6 pl-2 p-0 mb-2">
                                                        <label for="">Tipo de Documento:</label>
                                                        <div class="row ">
                                                            <div class="col-8 ">
                                                                <div class="form-group">

                                                                    <select name="tipoDoc" id="tipoDoc" class="form-control infoCliente form-control-sm text-uppercase">
                                                                        <option value="1">DNI</option>
                                                                        <option value="2">Carnet de fuerzas policiales</option>
                                                                        <option value="3">Carnet de fuerzas armadas</option>
                                                                        <option value="4">Carnet de extrangería</option>
                                                                        <option value="6" selected>RUC</option>
                                                                        <option value="7">Pasaporte</option>
                                                                        <option value="0">Otro tipo de documento</option>
                                                                    </select>

                                                                </div>
                                                            </div>
                                                            <div class="col-4">
                                                                <div class="form-group">
                                                                    <input class="form-control form-control-sm infoCliente text-uppercase" id="NroDoc" name="CDOCIDEN" onblur="buscarSunat(this.value)" title="Debe contener solo numeros">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div id="InfoCLi">


                                                            <div>
                                                                <div class="row">
                                                                    <div class="col-6">

                                                                        <input type="hidden" class="form-control form-control-sm mb-2 infoCliente text-uppercase" id="apPaterno" name="CAPELLIDO_PATERNO" placeholder="Apellido Paterno">



                                                                    </div>
                                                                    <div class="col-6">

                                                                        <input type="hidden" class="form-control form-control-sm mb-2 infoCliente text-uppercase" id="apMaterno" name="CAPELLIDO_MATERNO" placeholder="Apellido Materno">

                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-6">

                                                                        <input type="hidden" class="form-control form-control-sm infoCliente text-uppercase" id="pNombre" name="CPRIMER_NOMBRE" placeholder="Primer nombre">



                                                                    </div>
                                                                    <div class="col-6">

                                                                        <input type="hidden" class="form-control form-control-sm infoCliente text-uppercase" id="sNombre" name="CSEGUNDO_NOMBRE" placeholder="Segundo nombre">

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-12">

                                                                    <input type="text" class="form-control  infoCliente text-uppercase" id="nombreCli" name="CNOMCLI" placeholder="Nombre / Razon social">

                                                                </div>

                                                            </div>

                                                        </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label for="exampleInputPassword1">Teléfono:</label>
                                                    <input type="text" class="form-control infoCliente text-uppercase" id="celularPersona" name="CTELEFO">
                                                </div>
                                                <div class="form-group">
                                                    <label for="exampleInputPassword1">Correo:</label>
                                                    <input type="email" class="form-control infoCliente text-uppercase" name="CEMAIL" id="correoPersona">
                                                </div>

                                            </div>
                                            <div class="col-sm-6">

                                                <div class="form-group">
                                                    <label for="pagina">Página Web:</label>
                                                    <input type="text" class="form-control infoCliente text-uppercase" name="CHOST" id="paginaPersona">
                                                </div>

                                                <div class="form-group">
                                                    <label for="exampleInputPassword1">Tipo de Empresa:</label>
                                                    <div class="form-group">

                                                        <select name="tipoEmpresa" id="tipoEmpresa" class="form-control infoCliente  text-uppercase" required>
                                                            <option value="1">Terceros</option>
                                                            <option value="2">Matriz</option>
                                                            <option value="3">Subsidiarias</option>
                                                            <option value="4">Asociadas</option>
                                                            <option value="6">Sucursal</option>
                                                            <option value="7">Otros</option>
                                                        </select>

                                                    </div>
                                                </div>



                                            </div>
                                        </div>

                                    </div>
                                    <div class="tab-pane fade" id="nuevo-direccion" role="tabpanel" aria-labelledby="direccion-tab">
                                        <div class="form-group">
                                            <label>Domicilio legal:</label>
                                            <textarea class="form-control" rows="3" id="Direccion" name="CDIRCLI" onkeyup="textCounter(this.id,'counter_direccion',100)"></textarea>
                                            <label class="w-md-25 w-sm-50">
                                                <input id="counter_direccion" class="form-control w-50" value="100" readonly />
                                            </label>


                                            <div class="row mt-2">

                                                <div class="col-5">
                                                    <input type="text" class="form-control infoCliente text-uppercase" id="CPROV" name="CPROV" placeholder="Provincia">
                                                </div>
                                                <div class="col-7">
                                                    <input type="text" class="form-control infoCliente text-uppercase" id="CPAIS" name="CPAIS" placeholder="País">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="">Distrito:</label>

                                            @Html.DropDownList("distrito", ViewBag.Distrito as SelectList, "Selecciona un Distrito", htmlAttributes: new { @class = "form-control mw-100 select2 text-uppercase infoCliente" })


                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="nuevo-contacto" role="tabpanel" aria-labelledby="contacto-tab">
                                        <div id="Contacto" class="row text-cente flex-row flex-nowrap ">

                                            <div class="col-12  table-responsive">

                                                <table id="example2" class="table table-bordered table-hover">
                                                    <thead>
                                                        <tr>

                                                            <th>
                                                                Contacto
                                                            </th>
                                                            <th>
                                                                Área
                                                            </th>
                                                            <th>
                                                                Cargo
                                                            </th>
                                                            <th>
                                                                Correo
                                                            </th>
                                                            <th>
                                                                Teléfono
                                                            </th>
                                                            <th>
                                                                Celular
                                                            </th>
                                                            <th></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    </tbody>
                                                </table>

                                            </div>
                                        </div>


                                        <a id="agregarContactoPot" class="btn btn-sm btn-success text-white float-right">Agregar</a>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer justify-content-between">
                            <button type="button" class="btn btn-default" data-dismiss="modal" aria-label="Close">Descartar</button>
                            <button type="button" class="btn btn-primary" urlRetorno="@Url.Action("editar", "PROSPECTO" , new { id=Model.id_oportunidad, tipoCli=Model.tipoCliente, cliente=Model.idCliente })" id="nuevoClientepot">Guardar</button>
                        </div>

                    </form>
                </div>

            </div>

        </div>

        <div class="modal fade" id="modal_actividad" tabindex="0" role="dialog" aria-labelledby="Modal Central" aria-hidden="true">
            <div class="modal-dialog modal-md" role="document" id="m_tamanio">
                <div class="modal-content">
                    <div class="modal-header col-sm-12">

                        <h1 class="text-black-50 text-bold align-middle dato mb-0">
                            <i class="fa fa-clock"></i>&nbsp;
                            <span id="x_titulo">Actividad</span>
                        </h1>

                        <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="card card-primary card-tabs">
                        <div class="card-header navbar navbar-expand p-0 pt-1">
                            <ul class="navbar-nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="Actividadinfo-tab" data-toggle="pill" href="#Actividadinfo" role="tab" aria-controls="Actividadinfo" aria-selected="true">Información</a>
                                </li>

                                <li class="nav-item">
                                    <a class="nav-link" id="Cliente-tab" data-toggle="pill" href="#Cliente" role="tab" aria-controls="Cliente" aria-selected="false">Cliente</a>
                                </li>


                            </ul>


                        </div>

                        <div class="card-body">
                            <div class="tab-content" id="custom-tabs-one-tabContent">


                                <div class="tab-pane fade show active" id="Actividadinfo" role="tabpanel" aria-labelledby="Actividadinfo">
                                    <div class="row">

                                        <div class="col-12 ">
                                            <label>Título</label>
                                            <p id="Titulo"></p>
                                            <input type="hidden" id="id_tarea" value="" />
                                        </div>

                                        <div class="col-6">
                                            <label>Tipo de Actividad</label>
                                            <p id="tipoActividad"></p>
                                        </div>
                                        <div class="col-6">
                                            <label>Complemento</label>
                                            <p id="complemento"></p>
                                        </div>
                                        <div class="col-6">
                                            <label>Fecha Desde</label>
                                            <p id="fecha_inicio"></p>
                                        </div>
                                        <div class="col-6">
                                            <label>Fecha Hasta</label>
                                            <p id="fecha_final"></p>
                                        </div>
                                    </div>
                                    <div class="col-12 ">
                                        <label>Observaciones/Respuesta</label>
                                        <textarea id="respuesta" class="form-control" rows="3" onkeyup="textCounter(this.id,'counter_respuesta',500)"></textarea>
                                        <label class="w-md-25 w-sm-50">
                                            <input id="counter_respuesta" class="form-control w-50" value="500" readonly />
                                        </label>
                                    </div>
                                    <a id="btn_actualizar" class="btn btn-primary"> Actualizar</a>
                                </div>
                                <div class="tab-pane fade" id="Cliente" role="tabpanel" aria-labelledby="Cliente">
                                    <div class="form-group">
                                        <label for="exampleInputEmail1">Cliente:</label>
                                        <p id="clienteAct"></p>

                                        <div class="row mt-2">

                                            <div class="col-6">
                                                <label class="d-block" for="exampleInputEmail1">Llamar:</label>

                                                <a class="text-white text-md mr-3 btn btn-success" href="#" onclick="llamada(); return false;"><i alt="LLamada" class="img-circle text-center mt-auto mb-auto img-circle fas fa-phone-alt"></i></a>

                                                <div class="">

                                                </div>

                                            </div>
                                            <div class="col-6">
                                                <label class="d-block" for="exampleInputEmail1">Correo:</label>
                                                <a class="text-md text-white btn btn-info" href="#" onclick="enviarCorreo(); return false;"><i alt="Correo" class="img-circle text-center  mt-auto mb-auto img-circle far fa-envelope"></i></a>

                                            </div>

                                            <div id="correoActividad" class="col-12 hidden">

                                                <label for="">Para:</label>
                                                <input type="email" class="form-control text-uppercase" id="confirmarCorreo" placeholder="correo@correo.com" value="">

                                                <a id="linkcorreo" href="#" class="btn btn-primary">Contactar</a>


                                            </div>
                                            <div id="llamadaActividad" class="col-12 hidden">


                                                <label for="exampleInputEmail1">Teléfono:</label>

                                                <input type="tel" class="form-control text-uppercase" id="confirmarTelefono" placeholder="99999999" value="">



                                                <a id="linkLlamar" href="#" class="btn btn-primary">llamar</a>

                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-body h500" id="x_cuerpo">

                        <div class="modal-footer mr-auto ml-auto" id="x_pie ">

                            <a class="btn btn-default" data-dismiss="modal" aria-label="Close">
                                <i class="fa fa-times "></i>
                                Cerrar
                            </a>
                            <a id_cronograma="" id_oportunidad="" tipo="" urlRetorno="@Url.Action("editar", "PROSPECTO" , new { id=Model.id_oportunidad, tipoCli=Model.tipoCliente, cliente=Model.idCliente })" class="btn btn-success text-white" id="btn_realizado">
                                Marcar como Cerrado
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        @{
            Html.RenderPartial("_Cliente");
        }


    </div>
<script>
    var dataPotencial;

    var dataFidelizado;


    $(function () {

            $.ajax({
                url: "@Url.Content("~/Flujo/cargarPotencial")",
                dataType: "json",
                type: 'GET',
                cache: false,
                success: function (data) {




                    dataPotencial = data.potencial;

                }
            });

            $.ajax({
                url: "@Url.Content("~/Flujo/cargarFidelizado")",
                dataType: "json",
                type: 'GET',
                cache: false,
                success: function (data) {



                    dataFidelizado = data.fidelizado;


                }
            });

            $('#confirmarCorreo').keyup(function () {
                var correo = $(this).val()
                $("#linkcorreo").attr("href", 'mailto:' + correo + '?Subject=');

            });
            $('#confirmarTelefono').keyup(function () {
                var telefono = $(this).val()
                $("#linkLlamar").attr("href", 'tel: ' + telefono + '');


            });
        });

        function llamada() {
            $('#llamadaActividad').removeClass('hidden');
            $('#correoActividad').addClass('hidden');
        };
        function enviarCorreo() {
            $('#correoActividad').removeClass('hidden');
            $('#llamadaActividad').addClass('hidden');
        };

        function textCounter(f, c, maxlimit) {
            var field = $("#" + f)[0];
            var countfield = $("#" + c)[0];
            if (field.value.length > maxlimit) {// if too long...trim it!
                field.value = field.value.substring(0, maxlimit);
                // otherwise, update 'characters left' counter
            } else {
                countfield.value = maxlimit - field.value.length;
            }
        }
                //HILGER 030620
        function abrir_calendario(oportunidad) {
            var url = '@Url.Action("Index", "Calendario", new { propuestas = "asd" })';
            url = url.replace('asd', oportunidad);
            window.location.href = url;
        }

        $(function () {
            if ($('#finalTotal b').html() == undefined) {
                $('.cierreEstimado').html("sin planificación");
            } else {
                $('.cierreEstimado').html($('#finalTotal b').html());
            }


        });

        function cargarHistorico() {
            var idOportunidad = $('[name=idProspecto]').val();
            var data = { id: idOportunidad };
        $.ajax({
            url: "@Url.Content("~/Flujo/cargarHistorico")",
            dataType: "json",
            data: data,
            type: 'GET',
            cache: false,
            success: function (data) {


                var historico = $("#historico")[0];
                historico.length = 0;



                for (i = 0; i < data.historico.length; i++) {

                historico[i + 1] += '<div class="post"><div class=""><span class="username ">'

                historico[i + 1] += '<a class="text-black-50 text-bold" href="#"> ' + data.historico[i].id_usuario + ' </a>';

                historico[i + 1] += '' + data.historico[i].titulo + '';


                historico[i + 1] += '</span>';

                historico[i + 1] += '<p class="fecha">' + data.historico[i].fecha + '</p></div></div>';
                }

            }
        })
    };

        $('#cuerpo').on('click', '#actividad',function () {

            var id_cronograma = $(this).attr('id_cronograma');
            var idOportunidad = $(this).attr('idOportunidad');
            var tipo = $(this).attr('tipo');
            var data = { id_cronograma: id_cronograma, id_oportunidad: idOportunidad, tipo: tipo };
            $.ajax({
                url: "@Url.Content("~/Flujo/cargarActividad")",
                dataType: "json",
                data: data,
                type: 'GET',
                cache: false,
                success: function (data) {


                    $("#fecha_inicio").html("");
                    $("#fecha_final").html("");
                    $("#complemento").html("");
                    $("#tipoActividad").html("");
                    $("#Titulo").html("");
                    $("#clienteAct").html("");
                    $("#llamadaAct").html("");
                    $("#correoAct").html("");
                    $("#respuesta").val("");

                    $("#fecha_inicio").prepend(data.inicial);
                    $("#fecha_final").prepend(data.final);
                    $("#complemento").prepend(data.actividad[0].complemento);
                    $("#tipoActividad").prepend(data.actividad[0].Tipo_Actividad);
                    $("#Titulo").prepend(data.actividad[0].Titulo);
                    $("#respuesta").val(data.actividad[0].respuesta);
                    textCounter("respuesta", "counter_respuesta", 500)
                    $("#clienteAct").prepend(data.cliente[0].nombreCliente);
                    if (data.cliente[0].telefono != "") {
                        $("#confirmarTelefono").val(data.cliente[0].telefono);
                        $("#linkLlamar").attr("href", 'tel: ' + data.cliente[0].telefono + '');
                    }
                    if (data.cliente[0].correo != "") {
                        $("#confirmarCorreo").val(data.cliente[0].correo);
                        $("#linkcorreo").attr("href", 'mailto:' + data.cliente[0].correo + '');
                    }

                    if (data.actividad[0].estatus == 2) {
                        $("#modal_actividad .modal-header").attr('style', 'background: #dc3545; border-bottom-color: #dc3545;');
                        $("#modal_actividad .modal-header h1").removeClass('text-black-50');
                        $("#modal_actividad .modal-header h1").addClass('text-white');
                        $("#modal_actividad #respuesta").removeAttr('disabled');
                    }

                    if (data.actividad[0].estatus == 0) {
                        $("#modal_actividad .modal-header").attr('style', 'background: #fff; border-bottom-color: #fff;');
                        $("#modal_actividad .modal-header h1").addClass('text-black-50');
                        $("#modal_actividad .modal-header h1").removeClass('text-white');
                        $("#modal_actividad #respuesta").removeAttr('disabled');
                    }

                    $("#btn_realizado").attr('id_cronograma', data.actividad[0].Id_cronograma).attr('id_oportunidad', data.actividad[0].Id_oportunidad).attr('tipo', data.actividad[0].Tipo_Actividad);

                }

            });
        });
        $("#btn_actualizar").on('click', function () {
                    var id_cronograma = $("#btn_realizado").attr('id_cronograma');
                    var idOportunidad = $("#btn_realizado").attr('id_oportunidad');

                    var respuesta = $("#respuesta").val();

                    var data = { id_cronograma: id_cronograma, id_oportunidad: idOportunidad, respuesta: respuesta};
            $.ajax({
                url: "@Url.Content("~/Calendario/editarAsignadoCronograma")",
                dataType: "json",
                data: data,
                type: 'POST',
                success: function (datos) {


                    if (datos.Cambio == true) {

                        toastr.success('se actualizó con éxito.')

                    } else {
                        toastr.error('Algo salio mal.')
                    }
                    //cambiar por el otro modal



                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });
        });
        $("#btn_realizado").on('click', function () {
            var id_cronograma = $(this).attr('id_cronograma');
            var idOportunidad = $(this).attr('id_oportunidad');
            var tipo = $(this).attr('tipo');
            var retorno = $(this).attr('urlRetorno');
            var respuesta = $("#respuesta").val();

            var data = { id_cronograma: id_cronograma, id_oportunidad: idOportunidad, tipo: tipo, respuesta: respuesta };
            $.ajax({
                url: "@Url.Content("~/Calendario/cambiarEstatusCronograma")",
                dataType: "json",
                data: data,
                type: 'POST',
                success: function (datos) {


                    if (datos.Cambio == true) {



                        window.location.href = '' + retorno + '';
                    } else {
                        toastr.error('Algo salio mal.')
                    }
                    //cambiar por el otro modal



                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });
        });


        $("#cuerpo").on('click', '.modal .card .card-header li a', function () {
            $(this).parent().parent().parent().find("a").each(function () {
                $(this).removeClass('active');
                $(this).attr("aria-selected", 'false');
            });

            var objetivo = $(this).attr("href");
            $(this).addClass('active');
            $(this).attr("aria-selected", 'true');

            $(this).parent().parent().parent().parent().parent().parent().find('[role=tabpanel]').each(function () {

                $(this).removeClass('active');
                $(this).removeClass('show');


            });

            $(this).parent().parent().parent().parent().parent().parent().find(objetivo).addClass('active');
            $(this).parent().parent().parent().parent().parent().parent().find(objetivo).addClass('show');
        });

        if ($("[name=tipContacto]").val() == 0) {
            $("select[name=clientePot]").val('@Model.idCliente');
        } else {
            $("select[name=clienteFi]").val('@Model.idCliente');

        }

        $("#cuerpo").on('mouseenter', "#Actividades table tbody tr td", function () {
            $(this).attr("style", "background: rgba(128, 128, 128, .2);");
        });

        $("#cuerpo").on('mouseleave', "#Actividades table tbody tr td", function () {
            $(this).attr("style", "");
        })

        $("#cuerpo").on('click', "#Actividades table tbody tr td", function () {

        })

        $("#cuerpo").on('click', "#guardarCambios", function () {
            $(this).addClass('hidden');
            $("#editarPro").removeClass('disabled')
            $("#cliente").removeClass('hidden')
            $("#cambiarCliente").addClass('hidden')
            $(".prioridad_estrella").each(function () {
                $(this).addClass('Prioridad');
                $(this).removeClass('prioridad_estrella');
            });
        });
        $("#cuerpo").on('click', '#descartarCambios', function () {
            $("[name=tipContacto]").val(@Model.tipoCliente);
            $("#guardarCambios").addClass('hidden');
            $('#descartarCambios').addClass('hidden');
            $("#cliente").removeClass('hidden')
            $("#cambiarCliente").addClass('hidden')
            $('#editarPro').removeClass('disabled')
            $(".dato").each(function () {
                $(this).removeClass("hidden");
            });

            if ($("[name=tipContacto]").val() == 0) {
                $('#potencial').addClass('hidden');

            } else {
                $('#fidelizado').addClass('hidden');

            }

            $('#prioridad').val('@Model.id_prioridad');
                    valor = '@Model.id_prioridad';
                    if (valor == null) {
                        $('#prioridad').parent().find('#prio1').removeClass("fas fa-star");
                        $('#prioridad').parent().find('#prio1').addClass("far fa-star");
                        $('#prioridad').parent().find('#prio2').removeClass("fas fa-star");
                        $('#prioridad').parent().find('#prio2').addClass("far fa-star");
                        $('#prioridad').parent().find('#prio3').removeClass("fas fa-star");
                        $('#prioridad').parent().find('#prio3').addClass("far fa-star");

                        $('#prioridad').parent().find('#prio1').attr("style", "color: #000;");
                        $('#prioridad').parent().find('#prio2').attr("style", "color: #000;");
                        $('#prioridad').parent().find('#prio3').attr("style", "color: #000;");
                    }
            if (valor == 1) {
                $('#prio1').removeClass("far fa-star");
                $('#prio1').addClass("fas fa-star");

                $('#prio1').attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 2) {
                $('#prio2').parent().find('#prio1').removeClass("far fa-star");
                $('#prio2').parent().find('#prio1').addClass("fas fa-star");
                $('#prio2').removeClass("far fa-star");
                $('#prio2').addClass("fas fa-star");

                $('#prio2').parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $('#prio2').attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 3) {
                $('#prio3').parent().find('#prio1').removeClass("far fa-star");
                $('#prio3').parent().find('#prio1').addClass("fas fa-star");
                $('#prio3').parent().find('#prio2').removeClass("far fa-star");
                $('#prio3').parent().find('#prio2').addClass("fas fa-star");
                $('#prio3').removeClass("far fa-star");
                $('#prio3').addClass("fas fa-star");

                $('#prio3').parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $('#prio3').parent().find('#prio2').attr("style", "color: rgb(255, 149, 0)");
                $('#prio3').attr("style", "color: rgb(255, 149, 0)");
            }


            $(".info-prospecto").each(function () {

                if ($(this).attr('name') == 'tipoMoneda') {
                    $(this).val('@Model.TIPO_MONEDA.TIPOMON_SIMBOLO')
                    $(this).addClass('hidden');
                }

                if ($(this).attr('name') == 'Ingreso') {
                    $(this).val('@Model.ingreso')
                    $(this).addClass('hidden');


                }
                if ($(this).attr('name') == 'nombreOp') {
                    $(this).val('@Model.nombre')
                    $(this).attr("type", "hidden");

                }
                if ($(this).attr('name') == 'probabilidad') {
                    $(this).parent().addClass('hidden')
                    var cadena = '<input class="info-prospecto" type="hidden" id="range_5" name="probabilidad" value="@Model.porcentajeGanar">';
                    $(this).parent().find('.irs').remove();

                    $(this).parent().append(cadena);
                    $(this).remove();


                    $('#range_5').ionRangeSlider({
                        min: 0,
                        max: 100,
                        type: 'single',
                        step: 1,
                        postfix: ' %',
                        prettify: false,
                        hasGrid: true
                    });


                }

                     if ($(this).attr('name') == 'clientePot') {
                        $(this).val('@Model.idCliente');
                        cadena = `<select class ="form-control mw-100 select2 info-prospecto" id="clientePot"  data-placeholder="Prospecto"  name="clientePot"></select>`







                        $(this).parent().find('span').remove();
                        $(this).parent().prepend(cadena);
                        $(this).remove();
                        var potencial = $("#clientePot")[0];
                        potencial.length = 0;
                        for (i = 0; i < dataPotencial.length; i++) {
                            potencial[i + 1] = new Option(dataPotencial[i].CNOMCLI, dataPotencial[i].CCODCLI, "", "");
                        }


                        $("select[name=clientePot]").val('@Model.idCliente');
                        $('.select2').select2();
                    }


                    if ($(this).attr('name') == 'clienteFi') {
                        $(this).val('@Model.idCliente');
                        cadena = `<select class="form-control mw-100 select2 info-prospecto" id="clienteFi" data-placeholder="Cliente Fidelizado" name="clienteFi"></select> `

                        $(this).parent().find('span').remove();
                        $(this).parent().prepend(cadena);

                        $(this).remove();
                        var fidelizado = $("#clienteFi")[0];
                        fidelizado.length = 0;
                        for (i = 0; i < dataFidelizado.length; i++) {
                            fidelizado[i + 1] = new Option(dataFidelizado[i].CNOMCLI, dataFidelizado[i].CCODCLI, "", "");
                        }
                        $("select[name=clienteFi]").val('@Model.idCliente');

                        $('.select2').select2();
                    }




                if ($(this).attr('name') == 'notas') {
                    $(this).val('@Model.notas')
                    $(this).attr("type", "hidden");

                }



            });
            $(".Prioridad").each(function () {
                $(this).removeClass('prioridad_estrella');
                $(this).addClass('Prioridad');
            });
        });

            function cargarFidelizado() {
        $.ajax({
            url: "@Url.Content("~/Flujo/cargarFidelizado")",
            dataType: "json",
        type: 'GET',
        cache: false,
        success: function (data) {


            var fidelizado = $("#clienteFi")[0];
            fidelizado.length = 0;


            for (i = 0; i < data.fidelizado.length; i++) {
                fidelizado[i + 1] = new Option(data.fidelizado[i].CNOMCLI, data.fidelizado[i].CCODCLI, "", "");
            }}
        })
        };


            function cargarPotencial() {
        $.ajax({
            url: "@Url.Content("~/Flujo/cargarPotencial")",
            dataType: "json",
        type: 'GET',
        cache: false,
        success: function (data) {


            var potencial = $("#clientePot")[0];
            potencial.length = 0;


            for (i = 0; i < data.potencial.length; i++) {
                potencial[i + 1] = new Option(data.potencial[i].CNOMCLI, data.potencial[i].CCODCLI, "", "");
            }}
        })
        };

        $("#cuerpo").on('click', "#editarPro", function () {
            $('#listaEstado').addClass('hidden');
            if ($("[name=tipContacto]").val() == 0) {
                $('#potencial').removeClass('hidden');

            } else {
                $('#fidelizado').removeClass('hidden');

            }
            $("#guardarCambios").removeClass('hidden');
            $('#descartarCambios').removeClass('hidden');
            $("#cliente").addClass('hidden')
            $("#cambiarCliente").removeClass('hidden')
            $(this).addClass('disabled')
            $(".dato").each(function () {
                $(this).addClass("hidden");
            });
            $(".info-prospecto").each(function () {

                if ($(this).attr('name') == 'Ingreso') {

                    $(this).removeClass('hidden');
                } else {

                    if ($(this).attr('name') == 'tipoMoneda') {
                        $(this).removeClass('hidden');
                    } else {
                        if ($(this).attr('name') == 'probabilidad') {
                            $(this).parent().removeClass('hidden')

                        } else {
                            $(this).attr("type", "text");
                        }

                    }
                }


            });

            $(".Prioridad").each(function () {
                $(this).addClass('prioridad_estrella');
                $(this).removeClass('Prioridad');
            });



            $('#range_5').ionRangeSlider({
                min: 0,
                max: 100,
                type: 'single',
                step: 1,
                postfix: ' %',
                prettify: false,
                hasGrid: true
            });




        })

        $("input[name='tipoContacto']").change(function () {


            if (this.id == "ind_radio") {


                $("#cambiarCliente").find('#tipo').val(0);
                $("#cambiarCliente").find('#potencial').removeClass('hidden');
                $("#cambiarCliente").find('#fidelizado').addClass('hidden');


            } else {

                $("#cambiarCliente").find('#tipo').val(1);
                $("#cambiarCliente").find('#fidelizado').removeClass('hidden');
                $("#cambiarCliente").find('#potencial').addClass('hidden');

            }


        });

        $("#cuerpo").on('mouseenter', ".prioridad_estrella", function () {


            $(this).parent().find('#prio1').removeClass("fas fa-star");
            $(this).parent().find('#prio1').addClass("far fa-star");
            $(this).parent().find('#prio2').removeClass("fas fa-star");
            $(this).parent().find('#prio2').addClass("far fa-star");
            $(this).parent().find('#prio3').removeClass("fas fa-star");
            $(this).parent().find('#prio3').addClass("far fa-star");
            $(this).removeClass("fas fa-star");
            $(this).addClass("far fa-star");

            $(this).attr("style", "color: #000;");
            $(this).parent().find('#prio1').attr("style", "color: #000;");
            $(this).parent().find('#prio2').attr("style", "color: #000;");
            $(this).parent().find('#prio3').attr("style", "color: #000;");

            valor = $(this).attr("data-index");
            $(this).parent().find('#prioridad').attr("value", '0')
            if (valor == 1) {
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 2) {
                $(this).parent().find('#prio1').removeClass("far fa-star");
                $(this).parent().find('#prio1').addClass("fas fa-star");
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 3) {
                $(this).parent().find('#prio1').removeClass("far fa-star");
                $(this).parent().find('#prio1').addClass("fas fa-star");
                $(this).parent().find('#prio2').removeClass("far fa-star");
                $(this).parent().find('#prio2').addClass("fas fa-star");
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $(this).parent().find('#prio2').attr("style", "color: rgb(255, 149, 0)");
                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
        });

        $("#cuerpo").on('mouseleave', ".prioridad_estrella", function () {

            Prioridad = $(this).parent().find('#prioridad').attr("value");
            if (Prioridad == 0) {
                valor = $(this).attr("data-index");
                if (valor == 1) {
                    $(this).removeClass("fas fa-star");
                    $(this).addClass("far fa-star");

                    $(this).attr("style", "color: #000;");
                }
                if (valor == 2) {
                    $(this).parent().find('#prio1').removeClass("fas fa-star");
                    $(this).parent().find('#prio1').addClass("far fa-star");
                    $(this).removeClass("fas fa-star");
                    $(this).addClass("far fa-star");

                    $(this).attr("style", "color: #000;");
                    $(this).parent().find('#prio1').attr("style", "color: #000;");

                }
                if (valor == 3) {
                    $(this).parent().find('#prio1').removeClass("fas fa-star");
                    $(this).parent().find('#prio1').addClass("far fa-star");
                    $(this).parent().find('#prio2').removeClass("fas fa-star");
                    $(this).parent().find('#prio2').addClass("far fa-star");
                    $(this).removeClass("fas fa-star");
                    $(this).addClass("far fa-star");

                    $(this).attr("style", "color: #000;");
                    $(this).parent().find('#prio1').attr("style", "color: #000;");
                    $(this).parent().find('#prio2').attr("style", "color: #000;");
                }
            }


        });



        $("#cuerpo").on('click', ".prioridad_estrella", function () {


            valor = $(this).attr("data-index");
            $(this).parent().find('#prioridad').attr("value", valor)

            if (valor == 1) {
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 2) {
                $(this).parent().find('#prio1').removeClass("far fa-star");
                $(this).parent().find('#prio1').addClass("fas fa-star");
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 3) {
                $(this).parent().find('#prio1').removeClass("far fa-star");
                $(this).parent().find('#prio1').addClass("fas fa-star");
                $(this).parent().find('#prio2').removeClass("far fa-star");
                $(this).parent().find('#prio2').addClass("fas fa-star");
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $(this).parent().find('#prio2').attr("style", "color: rgb(255, 149, 0)");
                $(this).attr("style", "color: rgb(255, 149, 0)");
            }


        });


        // manejador que asegura que el valor tiene el formato correcto cuando
        // se modifica el valor, ya sea manual o con los botones inc/dec
        $('[name=Ingreso]').blur('input', function (event) {
            event.target.value = event.target.valueAsNumber.toFixed(2)
        });

        //boton Nueva Oportunidad
        var uri = '@Url.Action("nuevaOportunidad", "Home")';
        $('#guardarEmp').click(function () {
            nombre = $(this).parent().parent().find('#nombreEmpresa').val();
            celular = $(this).parent().parent().find('#celularEmpresa').val();
            telefono = $(this).parent().parent().find('#telefonoEmpresa').val();
            correo = $(this).parent().parent().find('#correoEmpresa').val();
            pagina = $(this).parent().parent().find('#paginaEmpresa').val();
            $('#crearIndividual').find('#nombreEmpresa input').attr("value", nombre);
            cadena = '<li class="select2-selection__choice" title="' + nombre + '" data-select2-id="179"><span class="select2-selection__choice__remove" role="presentation">×</span>Tennessee</li>';



            $(this).parent().parent().parent().find("#TODO").prepend(cadena);

            $.ajax({
                url: uri,
                data: { nombre: nombre, celular: celular, telefono: telefono, correo: correo, pagina: pagina },
                type: 'POST',

                success: function (data) {
                    toastr.success('Pedido validado satisfactoriamente.')
                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                }

            });
        });

        $("#cuerpo").on('change', 'select[name=Estado]', function () {


            //se agrega el campo de editar con la información del cliente
            var url = "@Url.Action("cambiarEstado", "Flujo")";
            var sourceId = $("[name=estadoActual]").val();
            var targetId = $(this).val();
            var retorno = $(this).attr('urlRetorno');
            var idOportunidad = "@Model.id_oportunidad";
            var data = { estadoInicial: sourceId, estadoFinal: targetId, idOportunidad: idOportunidad };


            $.ajax({
                url: url,
                data: data,
                type: 'POST',

                success: function (datos) {


                        window.location.href = '' + retorno +'';
                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });








        });
        //Para crear Contacto nuevo
        $("#cuerpo").on('click', "[id=agregarContacto]", function() {
            console.log("click")
            $(this).addClass('disabled')
            var cadena = `
                                                     <tr id="Nuevo">
                                                        <td class="align-middle columnaContacto">

                                                            <input type="text" class ="form-control form-control-sm mw-75 infoContacto" id="CONTACTO" name="CONTACTO">
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75 " id="AREA" name="AREA" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CARGO" name="CARGO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CORREO" name="CORREO" >
                                                        </td>
                                                        <td class="align-middle">
                                                            <input type="text" class ="form-control form-control-sm mw-75" id="TELEFONO" name="TELEFONO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="exampleInputPassword1" name="CELULAR" >
                                                        </td>

                                                        <td class ="align-middle">
                                                            <div class ="row justify-content-around text-center">
                                                                <div class ="col-auto">
                                                                    <a id="guardarNuevoContacto" class ="btn btn-xs btn-success"><i class ="fas fa-check text-white"></i></a>

                                                                </div>
                                                                <div class ="col-auto">

                                                                    <a id="removerNuevoContacto" class ="btn btn-xs btn-danger"><i class ="fas fa-times text-white"></i></a>
                                                                </div>

                                                            </div>
                                                        </td>
                                                    </tr>
                                `

            var CodCli = $(this).parent().find("table").attr('id');
            var tipoCliente = $(this).parent().find("table").attr('tipoCliente');
            var UltimoCod = $(this).parent().find('table tbody tr#guardado:last [name=COD_CONTACTO]').val();
            var Codigo = parseInt(UltimoCod) + parseInt("1");
            if (UltimoCod == null) {
                Codigo = 1;
            }

            $(this).parent().find('table tbody').append(cadena);

            $(this).parent().find("#removerNuevoContacto").click(function (event) { $(this).parent().parent().parent().parent().remove(); $("#cuerpo").find("#agregarContacto").removeClass('disabled'); });
            $(this).parent().find("#guardarNuevoContacto").click(function (event) {


                var paso = 1;
                var Cadena = `<tr id="guardado">`

                var dataNuevoContacto = "{COD_CLIENTE: '" + CodCli + "', COD_CONTACTO: '" + Codigo + "',";

                //recorre todos los input de contacto nuevo
                $(this).parent().parent().parent().parent().find("td [name]").each(function () {
                    if ($(this).attr("name") == 'CONTACTO' && $(this).val() == '') {
                        toastr.warning("el campo contacto debe estar lleno");
                        paso = 0;
                    } else {
                        //para crear la cadena a mostrar
                        if ($(this).attr("name") == 'CONTACTO') {
                            Cadena += `<td class ="align-middle"><p id="infoContacto" class="m-0">` + $(this).val() + `</p><input type="hidden" class ="form-control mw-75" id="COD_CLIENTE" name="COD_CLIENTE" value="` + CodCli + `">`;
                            Cadena += `<input type="hidden" class ="form-control mw-75 infoCli" id="tipoCli"  name="tipoCli" value="` + tipoCliente + `"><input type="hidden" class ="form-control mw-75" id="COD_CONTACTO" name="COD_CONTACTO" value="` + Codigo + `">`;
                            Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="exampleInputPassword1" name="CONTACTO" value="` + $(this).val() + `">`;
                            Cadena += `</td>`
                        } else {
                            Cadena += `<td class ="align-middle"><p id="infoContacto" class="m-0">` + $(this).val() + `</p>`;

                            Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="exampleInputPassword1" name="` + $(this).attr('name') + `" value="` + $(this).val() + `"></td>`

                        }
                        if ($(this).attr("name") == 'CELULAR') {
                            dataNuevoContacto += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                        } else {
                            dataNuevoContacto += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                        }
                    }

                });

                dataNuevoContacto += "}";

                if (paso == 1) {
                    if (tipoCliente == 0) {
                        var urlNuevoContacto = "@Url.Action("nuevoContactoPot", "Flujo")";
                        var json = eval("(" + dataNuevoContacto + ')');

                        $.post(urlNuevoContacto, json);


                        Cadena += `<td class ="align-middle"><div class ="row justify-content-around text-center"><div class ="col-auto"><a id="editarContacto" class="btn btn-xs btn-primary  pl-1 pr-1"><i class="fas fa-user-edit text-white"></i></a><a id="guardarEditado" class="btn btn-xs btn-success hidden"><i class="fas fa-check text-white"></i></a></div><div class ="col-auto"><a id="eliminarContacto" class ="btn btn-xs btn-danger"><i class ="far fa-trash-alt text-white"></i></a></div></div></td></tr>`



                        $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find('table tbody').append(Cadena);
                        $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find("#agregarContacto").removeClass('disabled');
                        $(this).parent().parent().parent().parent().remove();

                    } else {
                        var urlNuevoContacto = "@Url.Action("nuevoContactoFi", "Flujo")";
                        var json = eval("(" + dataNuevoContacto + ')');

                        $.post(urlNuevoContacto, json);

                        Cadena += `<td class ="align-middle"><div class ="row justify-content-around text-center"><div class ="col-auto"><a id="editarContacto" class="btn btn-xs btn-primary  pl-1 pr-1"><i class="fas fa-user-edit text-white"></i></a><a id="guardarEditado" class="btn btn-xs btn-success hidden"><i class="fas fa-check text-white"></i></a></div><div class ="col-auto"><a id="eliminarContacto" class ="btn btn-xs btn-danger"><i class ="far fa-trash-alt text-white"></i></a></div></div></td></tr>`


                        $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find('table tbody').append(Cadena);
                        $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find("#agregarContacto").removeClass('disabled');
                        $(this).parent().parent().parent().parent().remove();
                    }
                }
            });

        });

        //para editar cada contacto

        $("#cuerpo").on('click', '#formEditarCli tr td [id=guardarEditado]', function () {

            console.log($(this));
            var paso = 1;
            var Cadena = `<tr id="guardado">`
            var CodCli = $(this).parent().parent().parent().parent().find("[name=COD_CLIENTE]").val()
            var Codigo = $(this).parent().parent().parent().parent().find("td [name=COD_CONTACTO]").val();
            var tipoCliente = $(this).parent().parent().parent().parent().find('[name=tipoCli]').val();
            var data = "{COD_CLIENTE: '" + CodCli + "', COD_CONTACTO: '" + Codigo + "',";

            //recorre todos los input de contacto nuevo
            $(this).parent().parent().parent().parent().find("td [name]").each(function () {
                if ($(this).attr("name") == 'CONTACTO' && $(this).val() == '') {
                    alert("el campo contacto debe estar lleno");
                    paso = 0;
                } else {
                    //para crear la cadena a mostrar
                    if ($(this).attr("name") == 'COD_CONTACTO' || $(this).attr("name") == 'COD_CLIENTE' || $(this).attr("name") == 'tipoCli') {

                    } else {
                        $(this).parent().find('[id=infoContacto]').html($(this).val())
                        $(this).parent().find('[id=infoContacto]').removeClass('hidden')
                        $(this).attr('type', 'hidden');
                    }
                    if ($(this).attr("name") == 'CELULAR') {
                        data += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                    } else {
                        data += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                    }
                }
            });

            data += "}";

            if (paso == 1) {
                if (tipoCliente == 0) {
                    var urlEditarContacto = "@Url.Action("editarContactoPot", "Flujo")";
                    var json = eval("(" + data + ')');

                    $.post(urlEditarContacto, json)


                    $('#modal_editarClientePot').find('[id=guardarEditado]').addClass('hidden');
                    $('#modal_editarClientePot').find('[id=editarContacto]').removeClass('hidden');
                } else {
                    var urlEditarContacto = "@Url.Action("editarContactoFi", "Flujo")";
                    var json = eval("(" + data + ')');

                    $.post(urlEditarContacto, json)

                    $('#modal_editarClienteFi').find('[id=guardarEditado]').addClass('hidden');
                    $('#modal_editarClienteFi').find('[id=editarContacto]').removeClass('hidden');
                }

            }
        });

        //click al boton editar contacto

        $("#cuerpo").on('click', 'tr td [id=editarContacto]', function () {
            $(this).addClass('hidden');
            $(this).parent().find('#guardarEditado').removeClass('hidden');
            $(this).parent().parent().parent().parent().find("td").each(function () {
                $(this).find('p').addClass('hidden');
                if ($(this).find('.infoContacto').attr('name') == 'COD_CLIENTE' || $(this).find('.infoContacto').attr('name') == 'COD_CONTACTO') {

                } else {

                    $(this).find('.infoContacto').attr('type', 'text');

                }

            });
            $(this).parent().parent().parent().parent().find('[name=CONTACTO]').attr('type', 'text');
        });


        //click al boton eliminar contacto

        $("#cuerpo").on('click', '#formEditarCli tr td [id=eliminarContacto]', function () {

            var CodCli = $(this).parent().parent().parent().parent().find("[name=COD_CLIENTE]").val()
            var Codigo = $(this).parent().parent().parent().parent().find("td [name=COD_CONTACTO]").val();
            var tipoCliente = $(this).parent().parent().parent().parent().find('[name=tipoCli]').val();
            var data = "{COD_CLIENTE:'" + CodCli + "', COD_CONTACTO:'"+Codigo+"'}";

            if (tipoCliente == 0) {
                var urlEliminarContacto = "@Url.Action("EliminarContactoPot", "Flujo")";
                var json = eval("(" + data + ')');
                var elemento = $(this);
                $.ajax({
                    url: urlEliminarContacto,
                    data: json,
                    type: 'POST',

                    success: function (datos) {

                        elemento.parent().parent().parent().parent().remove();

                    },
                    error: function (error) {
                        toastr.error('Algo salio mal.')

                    },

                });




            } else {
                var urlEliminarContacto = "@Url.Action("EliminarContactoFi", "Flujo")";
                var json = eval("(" + data + ')');
                var elemento = $(this);
                $.ajax({
                    url: urlEliminarContacto,
                    data: json,
                    type: 'POST',

                    success: function (datos) {

                        elemento.parent().parent().parent().parent().remove();

                    },
                    error: function (error) {
                        toastr.error('Algo salio mal.')

                    },

                });
            }


        });




        $("#cuerpo").on('click', '#modeditarClientePot', function() {


            $("#modal_editarClientePot").find('select[name=tipoDoc]').change(function () {
                var tipoDoc = $(this).val();


                if (tipoDoc == 1 || tipoDoc == 2 || tipoDoc == 3) {

                    $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "hidden");

                } else {

                    $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "text");


                }
            });
            var urlEditarPot = "@Url.Action("editarPot", "Flujo")";


            $("#modal_editarClientePot").on('click', '#editarCliente', function() {


                var dataEditar = "{";
                $("#formEditarCli").find(".infoCliente").each(function () {


                    if ($(this).attr("name") == 'distrito') {
                        dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                    } else {
                        dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                    }

                });

                dataEditar += "}";
                console.log(dataEditar);
                var json = eval("(" + dataEditar + ')');

                $.ajax({
                    url: urlEditarPot,
                    data: json,
                    type: 'POST',

                    success: function (datos) {
                        $('#CNOMCLI').html('')
                        $('.mediaCliente').html('');

                        if (datos.resulado1 = true) {
                            $('#CNOMCLI').html('' + datos.CNOMCLI + '<a href="#" id="modeditarClienteFi" class="fas fa-edit" data-toggle="modal" data-target="#modal_editarClienteFi" value="" name="accion:Editar" style="background: #fff;"></a>')
                            $('.mediaCliente').append('<a class="text-success text-md mr-3"><i alt="LLamada" class="img-circle text-center mt-auto mb-auto img-circle fas fa-phone-alt"></i>' + datos.CTELEFO + '</a>')
                            $('.mediaCliente').append('<a class="text-md"><i alt="Correo" class="img-circle text-center  mt-auto mb-auto img-circle far fa-envelope"></i>' + datos.CEMAIL + '</a>')

                            var tabla = $('#Contacto table');

                            tabla.find('tbody tr').each(function () {
                                $(this).remove();
                            });
                            var cadena = ""
                            for (i = 0; i < datos.cONTACTO.length; i++) {
                                if (datos.cONTACTO[i].CORREO == null) {

                                    datos.cONTACTO[i].CORREO = "";
                                };
                                if (datos.cONTACTO[i].TELEFONO == null) {

                                    datos.cONTACTO[i].TELEFONO = "";
                                };
                                if (datos.cONTACTO[i].CELULAR == null) {

                                    datos.cONTACTO[i].CELULAR = "";
                                };

                                cadena += `
<tr id="guardado">

                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].CONTACTO + `</p>

                                                                                    </td>

                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].CORREO + `</p>

                                                                                    </td>
                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].TELEFONO + `</p>

                                                                                    </td>
                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].CELULAR + `</p>

                                                                                    </td>
</tr>
                                `;

                            }

                            tabla.find('tbody').html(cadena)
                        } else {
                            toastr.error('Algo salio mal.')
                        }



                    },
                    error: function (error) {
                        toastr.error('Algo salio mal.')

                    },

                });


            });
        });

        $("#cuerpo").on('click', '#modeditarClienteFi', function() {


            $("#modal_editarClienteFi").find('select[name=tipoDoc]').change(function () {
                var tipoDoc = $(this).val();


                if (tipoDoc == 1 || tipoDoc == 2 || tipoDoc == 3) {

                    $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "text");
                    $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "hidden");

                } else {

                    $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "hidden");
                    $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "text");


                }
            });
            var urlEditarFi = "@Url.Action("editarFidelizado", "Flujo")";


            $("#modal_editarClienteFi").on('click', '#editarCliente', function() {


                var dataEditar = "{";
                $("#formEditarCli").find(".infoCliente").each(function () {


                    if ($(this).attr("name") == 'distrito') {
                        dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                    } else {
                        dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                    }

                });

                dataEditar += "}";

                var json = eval("(" + dataEditar + ')');
                $.ajax({
                    url: urlEditarFi,
                    data: json,
                    type: 'POST',

                    success: function (datos) {
                        $('#CNOMCLI').html('')
                        $('.mediaCliente').html('');

                        if (datos.resulado1 = true) {
                            $('#CNOMCLI').html('' + datos.CNOMCLI + '<a href="#" id="modeditarClienteFi" class="fas fa-edit" data-toggle="modal" data-target="#modal_editarClienteFi" value="" name="accion:Editar" style="background: #fff;"></a>')
                            $('.mediaCliente').append('<a class="text-success text-md mr-3"><i alt="LLamada" class="img-circle text-center mt-auto mb-auto img-circle fas fa-phone-alt"></i>' + datos.CTELEFO + '</a>')
                            $('.mediaCliente').append('<a class="text-md"><i alt="Correo" class="img-circle text-center  mt-auto mb-auto img-circle far fa-envelope"></i>' + datos.CEMAIL + '</a>')

                            var tabla = $('#Contacto table');

                            tabla.find('tbody tr').each(function () {
                                $(this).remove();
                            });
                            var cadena = ""
                            for (i = 0; i < datos.cONTACTO.length; i++) {
                                if (datos.cONTACTO[i].CORREO == null) {

                                    datos.cONTACTO[i].CORREO = "";
                                };
                                if (datos.cONTACTO[i].TELEFONO == null) {

                                    datos.cONTACTO[i].TELEFONO = "";
                                };
                                if (datos.cONTACTO[i].CELULAR == null) {

                                    datos.cONTACTO[i].CELULAR = "";
                                };

                                 cadena += `
<tr id="guardado">

                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].CONTACTO+ `</p>

                                                                                    </td>

                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].CORREO + `</p>

                                                                                    </td>
                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].TELEFONO + `</p>

                                                                                    </td>
                                                                                    <td class="align-middle">
                                                                                        <p id="infoContacto" class="m-0">`+ datos.cONTACTO[i].CELULAR + `</p>

                                                                                    </td>
</tr>
                                `;

                            }

                            tabla.find('tbody').html(cadena)
                        } else {
                            toastr.error('Algo salio mal.')
                        }



                    },
                    error: function (error) {
                        toastr.error('Algo salio mal.')

                    },

                });


            });
        });



        //nuevo Contacto Cliente

        $("#modal_crearPotencial").find("#agregarContactoPot").click(function (event) {
            var CodCli = $("#modal_crearPotencial").find("[name=CCODCLI]").val();

            $(this).addClass('disabled')
            var cadena = `
                                                     <tr id="Nuevo">
                                                        <td class="align-middle columnaContacto">

                                                            <input type="text" class ="form-control form-control-sm mw-75 infoContacto" id="CONTACTO" name="CONTACTO">
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75 " id="AREA" name="AREA" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CARGO" name="CARGO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CORREO" name="CORREO" >
                                                        </td>
                                                        <td class="align-middle">
                                                            <input type="text" class ="form-control form-control-sm mw-75" id="TELEFONO" name="TELEFONO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CELULAR" name="CELULAR" >
                                                        </td>

                                                        <td class ="align-middle">
                                                            <div class ="row justify-content-around text-center">
                                                                <div class ="col-auto">
                                                                    <a id="guardarNuevoContacto" class ="btn btn-xs btn-success"><i class ="fas fa-check text-white"></i></a>

                                                                </div>
                                                                <div class ="col-auto">

                                                                    <a id="removerNuevoContacto" class ="btn btn-xs btn-danger"><i class ="fas fa-times text-white"></i></a>
                                                                </div>

                                                            </div>
                                                        </td>
                                                    </tr>
                                `

            var CodCli = $("#agregarContactoPot").find("[name=CCODCLI]").val();
            var UltimoCod = $(this).parent().find('table tbody tr#guardado:last [name=COD_CONTACTO]').val();
            var Codigo = parseInt(UltimoCod) + parseInt("1");
            if (UltimoCod == null) {
                Codigo = 1;
            }

            $(this).parent().find('table tbody').append(cadena);



        });
        $("#modal_crearPotencial").on('click', "#removerNuevoContacto", function (event) { $("#modal_crearPotencial").find('table tbody tr#Nuevo').remove(); $("#modal_crearPotencial").find("#agregarContactoPot").removeClass('disabled'); });
        $("#modal_crearPotencial").on('click', "#eliminarContacto", function (event) { $(this).parent().parent().parent().parent().remove(); });
        $("#modal_crearPotencial").on('click', "#guardarNuevoContacto", function (event) {
            var CodCli = $("#modal_crearPotencial").find("[name=CCODCLI]").val();
            var UltimoCod = $("#modal_crearPotencial").find('table tbody tr#guardado:last [id=COD_CONTACTO]').val();
            var Codigo = parseInt(UltimoCod) + parseInt("1");
            if (UltimoCod == null) {
                Codigo = 1;
            }

            var paso = 1;
            var Cadena = `<tr id="guardado">`



            //recorre todos los input de contacto nuevo
            $(this).parent().parent().parent().parent().find("td [name]").each(function () {
                if ($(this).attr("id") == 'CONTACTO' && $(this).val() == '') {
                    toastr.warning("el campo contacto debe estar lleno");
                    paso = 0;
                } else {
                    //para crear la cadena a mostrar
                    if ($(this).attr("id") == 'CONTACTO') {
                        Cadena += `<td class ="align-middle"><p class="m-0" id="infoContacto">` + $(this).val() + `</p><input type="hidden" contacto="` + Codigo + `" class ="form-control mw-75 infoContacto" id="COD_CLIENTE" name="COD_CLIENTE" value="` + CodCli + `">`;
                        Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="COD_CONTACTO" contacto="` + Codigo + `" name="COD_CONTACTO" value="` + Codigo + `">`;
                        Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="CONTACTO" contacto="` + Codigo + `" name="CONTACTO" value="` + $(this).val() + `">`;
                        Cadena += `</td>`
                    } else {
                        Cadena += `<td class ="align-middle"><p class="m-0" id="infoContacto">` + $(this).val() + `</p>`;

                        Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="` + $(this).attr('name') + `" contacto="` + Codigo + `" name="` + $(this).attr('name') + `" value="` + $(this).val() + `"></td>`

                    }
                }

            });
            if (paso == 1) {


                Cadena += `<td class ="align-middle"><div class ="row justify-content-around text-center"><div class ="col-auto"><a id="editarContacto" class="btn btn-xs btn-primary  pl-1 pr-1"><i class="fas fa-user-edit text-white"></i></a><a id="guardarEditado" class="btn btn-xs btn-success hidden"><i class="fas fa-check text-white"></i></a></div><div class ="col-auto"><a id="eliminarContacto" class ="btn btn-xs btn-danger"><i class ="far fa-trash-alt text-white"></i></a></div></div></td></tr>`



                $("#modal_crearPotencial").find('table tbody tr#Nuevo').remove();
                $("#modal_crearPotencial").find('table tbody').append(Cadena);
                $("#modal_crearPotencial").find("#agregarContactoPot").removeClass('disabled');


            }
        });

        //para editar cada contacto

        $("#modal_crearPotencial").on('click', 'tr td [id=guardarEditado]', function () {
            var paso = 1;
            var Cadena = `<tr id="guardado">`
            var CodCli = $("#modal_editarCliente").find("[name=CCODCLI]").val()
            var Codigo = $(this).find("td [name=COD_CONTACTO]").val();

            //recorre todos los input de contacto nuevo
            $(this).parent().parent().parent().parent().find("td [name]").each(function () {
                if ($(this).attr("name") == 'CONTACTO' && $(this).val() == '') {
                    toastr.warning("el campo contacto debe estar lleno");
                    paso = 0;
                } else {
                    //para crear la cadena a mostrar
                    if ($(this).attr("name") == 'COD_CONTACTO' || $(this).attr("name") == 'COD_CLIENTE') {

                    } else {
                        $(this).parent().find('[id=infoContacto]').html($(this).val())
                        $(this).parent().find('[id=infoContacto]').removeClass('hidden')
                        $(this).attr('type', 'hidden');
                    }
                }
            });


            if (paso == 1) {

                $(this).addClass('hidden');
                $(this).parent().find('#editarContacto').removeClass('hidden')
            }
        });


        //Validacion de formulario Crear Prospecto
    var validar = $('#formCrearpot').validate({
        rules: {
            CCODCLI: {
                required: true,
                maxlength: 11
            },
            CDOCIDEN: {
                required: true,
                maxlength: 15,
                number: true

            },
            CAPELLIDO_PATERNO: {
                maxlength: 20,

            },
            CAPELLIDO_MATERNO: {
                maxlength: 20,

            },
            CPRIMER_NOMBRE: {
                maxlength: 20,

            },
            CSEGUNDO_NOMBRE: {
                maxlength: 20,

            },
            CNOMCLI: {
                maxlength: 100,
                required: true
            },
            CEMAIL: {
                email: true
            },
            CDIRCLI: {
                maxlength: 100,

            },

        },
        messages: {
            CCODCLI: {
                required: "El codigo del cliente es requerido",
                maxlength: "El codigo no puede contener mas de 11 caracteres"
            },
            CDOCIDEN: {
                required: "El documento del cliente es requerido",
                maxlength: "El documento del cliente no puede contener mas de 15 caracteres",
                number: "El documento del cliente debe ser númerico"

            },
            CAPELLIDO_PATERNO: {
                maxlength: "El apellido paterno no puede contener mas de 20 caracteres",

            },
            CAPELLIDO_MATERNO: {
                maxlength: "El apellido materno no puede contener mas de 20 caracteres",

            },
            CPRIMER_NOMBRE: {
                maxlength: "El primer nombre no puede contener mas de 20 caracteres",

            },
            CSEGUNDO_NOMBRE: {
                maxlength: "El segundo nombre no puede contener mas de 20 caracteres",

            },
            CNOMCLI: {
                maxlength: "El nombre del cliente no puede contener mas de 100 caracteres",
                required: "El nombre del cliente o razon social es requerido",
            },
            CEMAIL: {
                email: "Introduzca un correo valido"
            },
            CDIRCLI: {
                maxlength: "La dirección no puede contener mas de 100 caracteres",

            },

        },
        errorElement: 'span',
        errorPlacement: function (error, element) {
            error.addClass('invalid-feedback');
            element.closest('.form-group').append(error);
        },
        highlight: function (element, errorClass, validClass) {
            $(element).addClass('is-invalid');
        },
        unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass('is-invalid');
        }
    });
        /*
        function buscarSunat(ruc) {

                var data = { ruc: ruc };
                $.ajax({
                    url: "http://www.starsoftweb.com/ServicioSunatRuc/api/PostTraerDatosSunat",
                    dataType: "json",
                    type: 'POST',

                    data: data,
                    success: function (datos) {
                        console.log(datos)
                    },
                    error: function (datos) {

                        Swal.fire({
                            title: "Alerta",
                            text: "No se encontro el ruc en el Sunat",
                            type: "error",
                            confirmButtonClass: "btn-danger",
                            confirmButtonText: "Aceptar",
                        });
                    }
                });


        };
        */

     $("#modal_crearPotencial").on('click', '#nuevoClientepot', function (event) {
        var retorno = $(this).attr('urlRetorno');
        va = validar.form();
        event.preventDefault();

     if (va) {
                        var primero = 0;
        var CodCli = $("#modal_crearPotencial").find("[name=CCODCLI]").val();
        var tipoDoc = $("#modal_crearPotencial").find('select[name=tipoDoc]').val();
        if (tipoDoc == 1 || tipoDoc == 2 || tipoDoc == 3) {

            var ApPaterno = $("#modal_crearPotencial").find('input#apPaterno').val();
            var ApMaterno = $("#modal_crearPotencial").find('input#apMaterno').val();
            var Snombre = $("#modal_crearPotencial").find('input#sNombre').val();
            var Pnombre = $("#modal_crearPotencial").find('input#pNombre').val();
            $("#modal_crearPotencial").find('input#nombreCli').val("" + ApPaterno + " " + ApMaterno + " " + Pnombre + " "+ Snombre + "")

        }

        if (CodCli == "") {
            toastr.error("Es necesario llenar el campo del Codigo de cliente.")
        } else {

            var UltimoCod = $("#modal_crearPotencial").find('table tbody tr#guardado:last [id=COD_CONTACTO]').val();
            var dataEditar = "{CONTACTO_COBRANZA: '', CCODCLAS: '', CCODTRANS: '',CFLAGPRIN: 'True',";
            $("#formCrearpot").find(".infoCliente").each(function () {
                if (UltimoCod == null) {
                    if ($(this).attr("name") == 'distrito') {
                        dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                    } else {
                        dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                    }

                } else {

                    dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "',";

                }
            });
            var longitud = 0;
            $("#formCrearpot").find(".infoContacto").each(function () {
                longitud = longitud + 1;
                //para crear la cadena a mostrar
                if ($(this).attr("contacto") == 1) {
                    if ($(this).attr("name") == 'COD_CLIENTE') {
                        dataEditar += "";
                    } else {
                        if ($(this).attr("name") == 'COD_CONTACTO') {

                            dataEditar += "ListadoContactoPot:[{COD_CONTACTO:'" + $(this).val() + "',";
                        } else {
                            if ($(this).attr("name") == 'CELULAR') {
                                dataEditar += "CELULAR:'" + $(this).val() + "'}";

                            } else {
                                dataEditar += "" + $(this).attr("name") + ":'" + $(this).val() + "',";
                            }
                        }

                    }

                } else {
                    if ($(this).attr("name") == 'COD_CLIENTE') {
                        dataEditar += ",{";
                    } else {
                        if ($(this).attr("name") == 'COD_CONTACTO') {
                            dataEditar += "COD_CONTACTO:'" + $(this).val() + "',";
                        } else {
                            if ($(this).attr("name") == 'CELULAR') {
                                dataEditar += "CELULAR:'" + $(this).val() + "'}";
                            } else {
                                dataEditar += "" + $(this).attr("name") + ":'" + $(this).val() + "',";
                            }
                        }

                    }

                }


            });

            var urlNuevoClientePot = "@Url.Action("crearPotencial", "Flujo")";
            if (longitud == 0) {
                dataEditar += "}";
            } else {
                dataEditar += "]}";
            }


            var json = eval("(" + dataEditar + ')');


            $.ajax({
                url: urlNuevoClientePot,
                dataType: "json",
                type: 'POST',

                data: json,
                success: function (datos) {
                    if (datos.jsonData == null) {

                        if (datos.resultado1 == true && datos.resultado2 == true) {

                            var potencial = $("#clientePot")[0];

                            potencial.length = 0;

                            toastr.success("se creó el cliente con éxito");
                            window.location.href = '' + retorno + '';

                            for (i = 0; i < datos.potencial.length; i++) {

                                    potencial[i + 1] = new Option(datos.potencial[i].CNOMCLI, datos.potencial[i].CCODCLI, "", "");


                            }

                            $("#modal_crearPotencial").modal("hide");

                            $("#clientePot").val(datos.id);
                        } else if (datos.resultado1 == true && datos.resultado2 == false) {
                            Swal.fire({
                                title: "Alerta",
                                text: datos.error,
                                type: "error",
                                confirmButtonClass: "btn-danger",
                                confirmButtonText: "Aceptar",
                            });
                            $("#modal_crearPotencial").modal("hide");

                        } else if (datos.resultado1 == false && datos.resultado2 == false) {
                            Swal.fire({
                                title: "Alerta",
                                text: datos.error,
                                type: "error",
                                confirmButtonClass: "btn-danger",
                                confirmButtonText: "Aceptar",
                            });

                        }

                    } else {

                        if (datos.jsonData.resultado1 == true && datos.jsonData.resultado2 == true) {

                            var potencial = $("#clientePot")[0];

                            potencial.length = 0;

                            toastr.success("se creó el cliente con éxito");
                            window.location.href = '' + retorno + '';

                            for (i = 0; i < datos.potencial.length; i++) {
                                potencial[i + 1] = new Option(datos.potencial[i].CNOMCLI, datos.potencial[i].CCODCLI, "", "");
                            }

                            $("#modal_crearPotencial").modal("hide");

                            $("#clientePot").val(datos.jsonData.id);
                        } else if (datos.jsonData.resultado1 == true && datos.jsonData.resultado2 == false) {
                            Swal.fire({
                                title: "Alerta",
                                text: datos.jsonData.error,
                                type: "error",
                                confirmButtonClass: "btn-danger",
                                confirmButtonText: "Aceptar",
                            });
                            $("#modal_crearPotencial").modal("hide");

                        } else if (datos.jsonData.resultado1 == false && datos.jsonData.resultado2 == false) {
                            Swal.fire({
                                title: "Alerta",
                                text: datos.jsonData.error,
                                type: "error",
                                confirmButtonClass: "btn-danger",
                                confirmButtonText: "Aceptar",
                            });
                        }
                    }




                },
                error: function (datos) {
                 if (datos.resultado1 == true && datos.resultado2 == false) {
                    Swal.fire({
                        title: "Alerta",
                        text: datos.error,
                        type: "error",
                        confirmButtonClass: "btn-danger",
                        confirmButtonText: "Aceptar",
                    });
                    $("#modal_crearPotencial").modal("hide");

                } else if (datos.resultado1 == false && datos.resultado2 == false) {
                    Swal.fire({
                        title: "Alerta",
                        text: datos.error,
                        type: "error",
                        confirmButtonClass: "btn-danger",
                        confirmButtonText: "Aceptar",
                    });
                }
                },

            });



        }
     }



    });
</script>