@model IEnumerable<CRM.Models.PROSPECTO>
@{
    List<CRM.Models.ESTADO_PROSPECTO> ESTADOS = ViewBag.estados;
    List<CRM.Models.POTENCIALCLI> ClientePot = ViewBag.ListaClientesPot;
    List<CRM.Models.TIPO_MONEDA> TipoMoneda = ViewBag.ListaTipoMoneda;
    List<CRM.Models.POTENCIALCLI> Fi = ViewBag.ListaClientesFi2;

    SelectList listaFi = new SelectList(ViewBag.ListaClientesFi, "CCODCLI", "CNOMCLI");
    SelectList listaPot = new SelectList(ClientePot, "CCODCLI", "CNOMCLI");
    SelectList ListaTipoMoneda = new SelectList(TipoMoneda, "TIPOMON_CODIGO", "TIPOMON_SIMBOLO", "MN");
    ViewBag.Title = "Lista de prospectos";
    int i = 0;
}

<link rel="stylesheet" href="@Url.Content("~/Content/Multinivel.css")">

<div id="cuerpo" class="container-fluid">
    <div class="content">
        <div class="container-fluid">
            <!--AQUI SE PONE EL CODIGO-->
            <div class="card card-primary card-outline">
                <div class="card-header ">
                    <h4 class="p-3 text-center"> Lista de Oportunidades</h4>
                    <div class="row">

                        <div class="col-12 col-sm-8 mb-2  text-center text-sm-left">
                            <a id="btnModalOp" class="btn btn-primary mb-3 text-white text-uppercase text-bold" data-toggle="modal" data-target="#m_nuevaOp">Nueva Oportunidad</a>


                        </div>
                        <div class="col-12 col-sm-4 mb-2  text-center text-sm-left">

                            <nav class="navbar navbar-expand navbar-light bg-light">


                                <div class="collapse navbar-collapse">
                                    <ul class="navbar-nav">

                                        <li class="nav-item dropdown">
                                            <a class="nav-link dropdown-toggle" href="http://example.com" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <i class="fa fa-filter" aria-hidden="true"></i>  Filtros
                                            </a>
                                            <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                                <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo")">Ver Todo</a></li>
                                                <li class="dropdown-submenu">
                                                    <a class="dropdown-item dropdown-toggle" aria-haspopup="true" aria-expanded="false" href="#">Estados</a>
                                                    <ul class="dropdown-menu">
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { Estatus = 1 })">Flujo</a></li>
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { Estatus = 3 })">Ganado</a></li>
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { Estatus = 4 })">Perdido</a></li>
                                                        <li class="dropdown-divider"></li>
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { Estatus = 2 })">Archivado</a></li>




                                                    </ul>
                                                </li>
                                                <li class="dropdown-submenu">
                                                    <a class="dropdown-item dropdown-toggle" href="#">Tipo de Cliente</a>
                                                    <ul class="dropdown-menu">
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { tipoCliente = 0 })">Prospectos</a></li>
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { tipoCliente = 1 })">Clientes</a></li>

                                                    </ul>
                                                </li>
                                                <li class="dropdown-submenu">
                                                    <a class="dropdown-item dropdown-toggle" href="#">Prioridad</a>
                                                    <ul class="dropdown-menu">
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { id_prioridad = 3 })">Alta</a></li>
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { id_prioridad = 2 })">Media</a></li>
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { id_prioridad = 1 })">Baja</a></li>
                                                        <li class="dropdown-divider"></li>
                                                        <li><a class="dropdown-item" href="@Url.Action("Lista", "Flujo" , new { id_prioridad = 0 })">Sin Prioridad</a></li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </nav>


                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="container-fluid overflow-auto">

                        <div id="tablero" class="row flex-row flex-nowrap ">

                            <div id="" class="col-12 p-0 table-responsive">
                                <table class="table table-striped projects">
                                    <thead>
                                        <tr>
                                            <th>
                                                Estado
                                            </th>
                                            <th>
                                                Descripcion
                                            </th>
                                            <th>
                                                Cliente
                                            </th>
                                            <th>
                                                Prioridad
                                            </th>
                                            <th>
                                                Actividad
                                            </th>
                                            <th>
                                                Probabilidad
                                            </th>
                                            <th>
                                                Ingreso
                                            </th>
                                            <th>
                                                Etapas
                                            </th>
                                            <th>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var Prospecto in Model.Where(m => m.id_usuario == Convert.ToString(Session["alias"])).OrderByDescending(p => p.id_prioridad))
                                        {
                                            <tr>
                                                <td>
                                                    @if (Prospecto.id_estatusProspecto == 1)
                                                    {

                                                        <span class="info-box-icon elevation-3 p-1 text-uppercase text-black-50 text-bold" style="background: @Prospecto.ESTATUS_PROSPECTO.color ;border-radius: 6px;">@Prospecto.ESTATUS_PROSPECTO.descripcion</span>
                                                    }
                                                    else
                                                    {
                                                        <span class="info-box-icon elevation-3 p-1 text-uppercase text-white text-bold" style="background: @Prospecto.ESTATUS_PROSPECTO.color ;border-radius: 6px;">@Prospecto.ESTATUS_PROSPECTO.descripcion</span>
                                                    }



                                                </td>
                                                <td>
                                                    <a>
                                                        @Html.DisplayFor(modelItem => Prospecto.nombre)
                                                    </a>
                                                    <br />


                                                    <small>
                                                        Creado @Html.DisplayFor(modelItem => Prospecto.fecha_inicial)
                                                    </small>


                                                </td>
                                                <td>
                                                    @if (Prospecto.tipoCliente == 0)

                                                    {



                                                        foreach (var cliPot in ClientePot)
                                                        {
                                                            if (Prospecto.idCliente == cliPot.CCODCLI)
                                                            {
                                                                <a data-toggle="tooltip" data-placement="top" title="Prospecto">
                                                                    <i class="far fa-user"></i>
                                                                    @cliPot.CNOMCLI
                                                                </a>

                                                            }
                                                        }

                                                    }
                                                    else
                                                    {

                                                        foreach (var cliFi in Fi)
                                                        {
                                                            if (Prospecto.idCliente == cliFi.CCODCLI)
                                                            {
                                                                <a data-toggle="tooltip" data-placement="top" title="Cliente">
                                                                    <i class="fas fa-user"></i>
                                                                    @cliFi.CNOMCLI
                                                                </a>
                                                            }
                                                        }
                                                    }
                                                </td>
                                                <td>
                                                    <p class="text-lg mb-0">
                                                        <div class="prioridad op_abajo_izq float-left ">
                                                            @if (Prospecto.id_prioridad == 0)
                                                            {

                                                                <a href="#" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad  far fa-star" style="color: #000;"></a>
                                                                <a href="#" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad far fa-star" style="color: #000;"></a>
                                                                <a href="#" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad far fa-star" style="color: #000"></a>
                                                            }

                                                            @if (Prospecto.id_prioridad == 1)
                                                            {

                                                                <a href="#" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad  far fa-star" style="color: #000;"></a>
                                                                <a href="#" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad far fa-star" style="color: #000;"></a>
                                                                <a href="#" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                            }
                                                            @if (Prospecto.id_prioridad == 2)
                                                            {

                                                                <a href="#" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad  far fa-star" style="color: #000;"></a>
                                                                <a href="#" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                                <a href="#" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                            }
                                                            @if (Prospecto.id_prioridad == 3)
                                                            {

                                                                <a href="#" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                                <a href="#" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                                <a href="#" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right Prioridad fas fa-star" style="color: rgb(255, 149, 0)"></a>
                                                            }

                                                            <input type="hidden" id="prioridad" name="id_prioridad" value="@Prospecto.id_prioridad">

                                                        </div>
                                                    </p>

                                                </td>
                                                <td class="">
                                                    <div class="btn-group" style="position: relative;">


                                                        <div class="dropdown-menu p-0">
                                                            @foreach (var plan in Prospecto.CRONOGRAMA.Where(p => p.estatus == 0 || p.estatus == 2))
                                                            {

                                                                if (plan.fecha_inicial > DateTime.Now && plan.fecha_final > DateTime.Now)
                                                                {
                                                                    <div id="actividad" estatus="@plan.estatus" tipo="@plan.id_tipoActividad" id_cronograma="@plan.id_cronograma" idOportunidad="@plan.id_oportunidad" data-toggle="tooltip" data-placement="top" title="@plan.fecha_inicial.ToString("dd/MM/yyyy HH:mm") a @plan.fecha_final.ToString("dd/MM/yyyy HH:mm")" class="dropdown-item bg-gradient-olive">
                                                                        <a class="media align-middle" data-toggle="modal" data-target="#modal_actividad" style="cursor: pointer;">

                                                                            <div class="media-body text-left mt-auto mb-auto p-2">
                                                                                <h3 class="dropdown-item-title">

                                                                                    @Html.DisplayFor(modelItem => plan.TIPO_ACTIVIDAD.descripcion)

                                                                                </h3>

                                                                            </div>
                                                                        </a>
                                                                    </div>
                                                                }
                                                                if (plan.fecha_inicial < DateTime.Now && plan.fecha_final > DateTime.Now)
                                                                {
                                                                    <div id="actividad" estatus="@plan.estatus" tipo="@plan.id_tipoActividad" id_cronograma="@plan.id_cronograma" idOportunidad="@plan.id_oportunidad" data-toggle="tooltip" data-placement="top" title="@plan.fecha_inicial.ToString("dd/MM/yyyy HH:mm") a @plan.fecha_final.ToString("dd/MM/yyyy HH:mm")" class="dropdown-item bg-gradient-yellow">
                                                                        <a class="media align-middle" data-toggle="modal" data-target="#modal_actividad" style="cursor: pointer;">

                                                                            <div class="media-body text-left mt-auto mb-auto p-2">
                                                                                <h3 class="dropdown-item-title">

                                                                                    @Html.DisplayFor(modelItem => plan.TIPO_ACTIVIDAD.descripcion)

                                                                                </h3>
                                                                            </div>
                                                                        </a>
                                                                    </div>
                                                                }

                                                                if (plan.fecha_inicial < DateTime.Now && plan.fecha_final < DateTime.Now)
                                                                {
                                                                    <div id="actividad" estatus="@plan.estatus" tipo="@plan.id_tipoActividad" id_cronograma="@plan.id_cronograma" idOportunidad="@plan.id_oportunidad" data-toggle="tooltip" data-placement="top" title="@plan.fecha_inicial.ToString("dd/MM/yyyy HH:mm") a @plan.fecha_final.ToString("dd/MM/yyyy HH:mm")" class="dropdown-item bg-gradient-danger">
                                                                        <a class="media align-middle" data-toggle="modal" data-target="#modal_actividad" style="cursor: pointer;">

                                                                            <div class="media-body text-left mt-auto mb-auto p-2">
                                                                                <h3 class="dropdown-item-title">

                                                                                    @Html.DisplayFor(modelItem => plan.TIPO_ACTIVIDAD.descripcion)

                                                                                </h3>


                                                                            </div>
                                                                        </a>
                                                                    </div>
                                                                }





                                                                i = i + 1;
                                                            }
                                                            @if (i == 0)
                                                            {
                                                                <div class="dropdown-item">
                                                                    <small>
                                                                        No tienes Actividades asignadas
                                                                    </small>
                                                                </div>
                                                            }

                                                            <div class="dropdown-divider"></div>
                                                            <a href="javascript:void(0)" onclick="abrir_calendario('@Prospecto.id_oportunidad')" class="dropdown-item dropdown-footer">Crear actividades  <i class="far fa-calendar-alt"></i></a>
                                                        </div>
                                                        <a class="nav-link" data-toggle="dropdown" href="#">
                                                            <i class="far fa-clock  fa-2x"></i>
                                                            <span class="badge badge-danger navbar-badge text-bold" style="font-size: .8rem;">@i</span>
                                                        </a>

                                                    </div>

                                                </td>
                                                <td class="porcentaje">
                                                    @if (Prospecto.porcentajeGanar != null)
                                                    {
                                                        <div class="progress progress-sm">
                                                            <div class="progress-bar bg-green" role="progressbar" aria-volumenow="@Prospecto.porcentajeGanar" aria-volumemin="0" aria-volumemax="100" style="width: @Prospecto.porcentajeGanar%">
                                                            </div>
                                                        </div>
                                                        <small>
                                                            @Prospecto.porcentajeGanar% a convertir
                                                        </small>
                                                    }

                                                </td>
                                                <td class="Ingreso">
                                                    @foreach (var moneda in TipoMoneda)
                                                    {
                                                        if (Prospecto.codigo_tipoMon == moneda.TIPOMON_CODIGO)
                                                        {
                                                            <span id="simboloMon">@moneda.TIPOMON_SIMBOLO</span><span id="ingreso" class="ml-2">@Prospecto.ingreso</span>
                                                        }
                                                    }

                                                </td>
                                                <td class="project-state">

                                                    @foreach (var estado in ESTADOS)
                                                    {
                                                        if (Prospecto.id_estadoOporunidad == estado.id_estadoOportunidad)
                                                        {
                                                            SelectList listaEstado = new SelectList(ESTADOS, "id_estadoOportunidad", "decripcion", estado.id_estadoOportunidad);

                                                            @Html.DropDownList("Estado", listaEstado as SelectList, null, htmlAttributes: new { @class = "form-control form-control-static  mw-100", @style = "width: 200px", @idOportunidad = Prospecto.id_oportunidad })

                                                        }
                                                    }

                                                </td>
                                                <td class="project-actions text-right">
                                                    <a class="btn btn-primary btn-sm" href="@Url.Action("editar", "PROSPECTO" , new { id=Prospecto.id_oportunidad, tipoCli=Prospecto.tipoCliente, cliente=Prospecto.idCliente })">
                                                        <i class="fas fa-folder">
                                                        </i>
                                                        Ver
                                                    </a>

                                                </td>
                                            </tr>
                                            i = 0;
                                        }
                                    </tbody>
                                </table>
                            </div>



                        </div>


                    </div>
                </div>
            </div>




            <!-- /.row -->
        </div><!-- /.container-fluid -->
    </div>







    <div class="modal fade" id="m_nuevaOp" tabindex="0" role="dialog" aria-labelledby="Modal Central" aria-hidden="true">
        @using (Html.BeginForm("nuevoProspecto", "flujo", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
            @Html.AntiForgeryToken()
            <div class="modal-dialog modal-md" role="document" id="nueva">
                <div class="modal-content">
                    <div class="modal-header col-sm-12">
                        <div class="modal-title">
                            <h1 class="text-primary text-uppercase mb-0"> nueva Oportunidad</h1>

                        </div>
                        <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body h500" id="">

                        <div class="row justify-content-around mb-2 ml-0 mr-0 p-2">
                            <input type="hidden" name="idEstatus" value="1" />
                            <input type="hidden" name="nombreEstado" value="" />
                            <input type="hidden" name="idUsuario" value="@Session["alias"]" />

                            <div class="col-12 p-0  mb-2 ">

                                <label for="Num_Op" class="usuario text-left  w-100 mb-0"> Nombre:</label>
                                <input class="w-100 form-control" id="Num_Op" name="nombreOp" required="required" type="text" placeholder="Descripción" />

                            </div>
                            <div class="col-12 p-0 mb-0 ">
                                <label for="Num_Op" class="usuario text-left  w-100  pl-2 mb-0"> Cliente: </label>
                                <article class="kanban-entry" draggable="false">
                                    <div class="kanban-entry-inner">
                                        <div class="row justify-content-between p-2 mb-2 m-0">
                                            <div class="col-12  p-0 mb-2  ">
                                                <div class="form-group">
                                                    <div class="row">
                                                        <div class="col-6 text-right">
                                                            <div class="custom-control custom-radio">
                                                                <input class="custom-control-input" type="radio" id="ind_radio" name="tipoContacto" required="required" checked>
                                                                <label for="ind_radio" class="custom-control-label">Prospecto <i class="far fa-user"></i></label>
                                                            </div>
                                                        </div>
                                                        <div class="col-6 text-left">
                                                            <div class="custom-control custom-radio">
                                                                <input class="custom-control-input" type="radio" id="emp_radio" name="tipoContacto" required="required">
                                                                <label for="emp_radio" class="custom-control-label">Fidelizado <i class="fas fa-user"></i></label>
                                                            </div>

                                                        </div>

                                                    </div>
                                                </div>


                                                <div class="col-12 " id="contenidoTipo">
                                                    <input type="hidden" id="tipo" name="tipContacto" value="0">
                                                    <div id="potencial" class="potencial">
                                                        <div class="row p-0 d-flex align-items-center">



                                                            <div class="col-12 p-0">
                                                                <div class="form-group">

                                                                    <select class="form-control mw-100 select2" id="clientePot" data-placeholder="Prospecto"  required="" name="clientePot"></select>

                                                                </div>

                                                            </div>
                                                            <div class="p-0 mb-3 pl-3 col-1 hidden" id="editar">
                                                                <div class="input-group">
                                                                    <div class="input-group-append">
                                                                        <a href="#" id="modeditarClientePot" class="fas fa-edit" data-toggle="modal" data-target="#modal_editarClientePot" value="" name="accion:Editar" style="background: #fff;"></a>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <a href="#" class="btn  btn-contacto w-100 p-0 font-weight-bold" data-toggle="modal" data-target="#modal_crearPotencial"><i class="fas fa-user-plus  pr-2" style="color: #0275d8"></i>Agregar prospecto</a>

                                                        </div>
                                                    </div>
                                                    <div id="fidelizado" class="fidelizado hidden">
                                                        <div class="row p-0 d-flex align-items-center">



                                                            <div class="col-12 p-0">
                                                                <div class="form-group">

                                                                    @Html.DropDownList("clienteFi", listaFi as SelectList, "Cliente", htmlAttributes: new { @class = "form-control mw-100 select2" })



                                                                </div>

                                                            </div>
                                                            <div class="p-0 mb-3 pl-3 col-1 hidden" id="editar">
                                                                <div class="input-group">
                                                                    <div class="input-group-append">
                                                                        <a href="#" id="modeditarClienteFi" class="fas fa-edit" data-toggle="modal" data-target="#modal_editarClienteFi" value="" name="accion:Editar" style="background: #fff;"></a>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </article>

                            </div>



                            <div class="col-12 mb-2">
                                <label for="in" class="text-left mb-0">Probabilidad para Convertir: </label>
                                <input id="range_5" type="text" name="probabilidad" value="">
                            </div>

                            <div class="col-12 ">
                                <div class="prioridad">
                                    <label for="in" class="text-left mb-0">Prioridad:</label>

                                    <a href="#" onclick="return false;" title="Alta" id="prio3" aria-label="Alta" data-index="3" class="float-right prioridad_estrella far fa-star" style="color: #000;"></a>
                                    <a href="#" onclick="return false;" title="Media" id="prio2" aria-label="Media" data-index="2" class="float-right prioridad_estrella far fa-star" style="color: #000;"></a>
                                    <a href="#" onclick="return false;" title="Baja" id="prio1" aria-label="Baja" data-index="1" class="float-right prioridad_estrella far fa-star " style="color: #000;"></a>
                                    <input type="hidden" id="prioridad" name="prioridadVal" value="0">

                                </div>
                                <div class="row  justify-content-around  p-0">

                                    <div class="col-7 p-0"><label for="in" class="text-left  w-100">Ingreso Estimado</label><input class="w-100 pl-2 form-control" id="in" name="Ingreso" value="0.00" type="number" step="0.01" /></div>
                                    <div class="col-4 p-0"><label for="" class="youpasswd text-left  w-100">Moneda</label>@Html.DropDownList("tipoMoneda", ListaTipoMoneda as SelectList, null, htmlAttributes: new { @class = "form-control mw-100", @required = "required" })</div>
                                </div>
                                <div class="row">
                                    <div class="col">

                                        @{
                                            SelectList listaEstado = new SelectList(ESTADOS, "id_estadoOportunidad", "decripcion");
                                            <label class="d-block mt-2">Seleccionar una Etapa Destino</label>
                                            @Html.DropDownList("idEstadoOp", listaEstado as SelectList, null, htmlAttributes: new { @class = "form-control mw-100 select2", @id = "idEstadoOp", @required = "required" });
                                        }

                                    </div>
                                </div>
                            </div>



                        </div>
                    </div>


                    <div class="modal-footer" id="x_pie">
                        <div class="col-12 mt-2">
                            <div class="form-group">
                                <input type="hidden" id="vista" name="vista" value="Lista">
                                <input type="submit" id="nuevaOportunidad" class="btn btn-primary" value="Añadir">
                                <a class="btn btn-default" data-dismiss="modal" aria-label="Close">Cancelar</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
    <div class="modal fade" id="modal_crearPotencial">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Crear Prospecto</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form role="form" class="" id="formCrearpot">
                    <div class="card card-primary card-tabs">
                        <div class="card-header navbar navbar-expand p-0 pt-1">
                            <ul class="navbar-nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="crear-tab" data-toggle="pill" href="#nuevo-cliente" role="tab" aria-controls="nuevo-cliente" aria-selected="true">Datos</a>
                                </li>

                                <li class="nav-item">
                                    <a class="nav-link" id="direccion-tab" data-toggle="pill" href="#nuevo-direccion" role="tab" aria-controls="nuevo-direccion" aria-selected="false">Direcciones</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="contacto-tab" data-toggle="pill" href="#nuevo-contacto" role="tab" aria-controls="nuevo-contacto" aria-selected="false">Contactos</a>
                                </li>

                            </ul>


                        </div>

                        <div class="card-body">
                            <div class="tab-content" id="custom-tabs-one-tabContent">


                                <div class="tab-pane fade show active" id="nuevo-cliente" role="tabpanel" aria-labelledby="nuevo-cliente">
                                    <div class="row ">
                                        <div class="col-12 ">
                                            <div class="row text-left  m-0">
                                                <div class="col-sm-6  p-0 pr-2 mb-2  ">


                                                    <div class="form-group">
                                                        <label for="">Código del cliente:</label>
                                                        <input type="text" class="form-control form-control-sm infoCliente text-uppercase" name="CCODCLI" id="codCli">
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 pl-2 p-0 mb-2">
                                                    <label for="">Tipo de Documento:</label>
                                                    <div class="row ">
                                                        <div class="col-8 ">
                                                            <div class="form-group">

                                                                <select name="tipoDoc" id="tipoDoc" class="form-control infoCliente form-control-sm text-uppercase">
                                                                    <option value="1">DNI</option>
                                                                    <option value="2">Carnet de fuerzas policiales</option>
                                                                    <option value="3">Carnet de fuerzas armadas</option>
                                                                    <option value="4">Carnet de extrangería</option>
                                                                    <option value="6" selected>RUC</option>
                                                                    <option value="7">Pasaporte</option>
                                                                    <option value="0">Otro tipo de documento</option>
                                                                </select>

                                                            </div>
                                                        </div>
                                                        <div class="col-4">
                                                            <div class="form-group">
                                                                <input class="form-control form-control-sm infoCliente text-uppercase" id="NroDoc" name="CDOCIDEN" title="Debe contener solo numeros">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="InfoCLi">


                                                        <div>
                                                            <div class="row">
                                                                <div class="col-6">

                                                                    <input type="hidden" class="form-control form-control-sm mb-2 infoCliente text-uppercase" id="apPaterno" name="CAPELLIDO_PATERNO" placeholder="Apellido Paterno">



                                                                </div>
                                                                <div class="col-6">

                                                                    <input type="hidden" class="form-control form-control-sm mb-2 infoCliente text-uppercase" id="apMaterno" name="CAPELLIDO_MATERNO" placeholder="Apellido Materno">

                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-6">

                                                                    <input type="hidden" class="form-control form-control-sm infoCliente text-uppercase" id="pNombre" name="CPRIMER_NOMBRE" placeholder="Primer nombre">



                                                                </div>
                                                                <div class="col-6">

                                                                    <input type="hidden" class="form-control form-control-sm infoCliente text-uppercase" id="sNombre" name="CSEGUNDO_NOMBRE" placeholder="Segundo nombre">

                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-12">

                                                                <input type="text" class="form-control  infoCliente text-uppercase" id="nombreCli" name="CNOMCLI" placeholder="Nombre / Razon social">

                                                            </div>

                                                        </div>

                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <div class="form-group">
                                                <label for="exampleInputPassword1">Teléfono:</label>
                                                <input type="text" class="form-control infoCliente text-uppercase" id="celularPersona" name="CTELEFO">
                                            </div>
                                            <div class="form-group">
                                                <label for="exampleInputPassword1">Correo:</label>
                                                <input type="email" class="form-control infoCliente text-uppercase" name="CEMAIL" id="correoPersona">
                                            </div>

                                        </div>
                                        <div class="col-sm-6">

                                            <div class="form-group">
                                                <label for="pagina">Página Web:</label>
                                                <input type="text" class="form-control infoCliente text-uppercase" name="CHOST" id="paginaPersona">
                                            </div>

                                            <div class="form-group">
                                                <label for="exampleInputPassword1">Tipo de Empresa:</label>
                                                <div class="form-group">

                                                    <select name="tipoEmpresa" id="tipoEmpresa" class="form-control infoCliente  text-uppercase" required>
                                                        <option value="1">Terceros</option>
                                                        <option value="2">Matriz</option>
                                                        <option value="3">Subsidiarias</option>
                                                        <option value="4">Asociadas</option>
                                                        <option value="6">Sucursal</option>
                                                        <option value="7">Otros</option>
                                                    </select>

                                                </div>
                                            </div>



                                        </div>
                                    </div>

                                </div>
                                <div class="tab-pane fade" id="nuevo-direccion" role="tabpanel" aria-labelledby="direccion-tab">
                                    <div class="form-group">
                                        <label>Domicilio legal:</label>
                                        <textarea class="form-control" rows="3" id="Direccion" name="CDIRCLI" onkeyup="textCounter(this.id,'counter_direccion',100)"></textarea>
                                        <label class="w-md-25 w-sm-50">
                                            <input id="counter_direccion" class="form-control w-50" value="100" readonly />
                                        </label>


                                        <div class="row mt-2">

                                            <div class="col-5">
                                                <input type="text" class="form-control infoCliente text-uppercase" id="CPROV" name="CPROV" placeholder="Provincia">
                                            </div>
                                            <div class="col-7">
                                                <input type="text" class="form-control infoCliente text-uppercase" id="CPAIS" name="CPAIS" placeholder="País">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="">Distrito:</label>

                                        <!--Html.DropDownList("distrito", ViewBag.Distrito as SelectList, "Selecciona un Distrito", htmlAttributes: new { class = "form-control mw-100 select2 text-uppercase infoCliente" })-->


                                    </div>
                                </div>
                                <div class="tab-pane fade" id="nuevo-contacto" role="tabpanel" aria-labelledby="contacto-tab">
                                    <div id="Contacto" class="row text-cente flex-row flex-nowrap ">

                                        <div class="col-12  table-responsive">

                                            <table id="example2" class="table table-bordered table-hover">
                                                <thead>
                                                    <tr>

                                                        <th>
                                                            Contacto
                                                        </th>
                                                        <th>
                                                            Área
                                                        </th>
                                                        <th>
                                                            Cargo
                                                        </th>
                                                        <th>
                                                            Correo
                                                        </th>
                                                        <th>
                                                            Teléfono
                                                        </th>
                                                        <th>
                                                            Celular
                                                        </th>
                                                        <th></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                </tbody>
                                            </table>

                                        </div>
                                    </div>


                                    <a id="agregarContactoPot" class="btn btn-sm btn-success text-white float-right">Agregar</a>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-default" data-dismiss="modal" aria-label="Close">Descartar</button>
                        <button type="button" class="btn btn-primary" id="nuevoClientepot">Guardar</button>
                    </div>

                </form>
            </div>

        </div>

    </div>



    <div class="modal fade" id="modal_actividad" tabindex="0" role="dialog" aria-labelledby="Modal Central" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document" id="m_tamanio">
            <div class="modal-content">
                <div class="modal-header col-sm-12">

                    <h1 class="text-black-50 text-bold align-middle dato mb-0">
                        <i class="fa fa-clock"></i>&nbsp;
                        <span id="x_titulo">Actividad</span>
                    </h1>

                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="card card-primary card-tabs">
                    <div class="card-header navbar navbar-expand p-0 pt-1">
                        <ul class="navbar-nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="Actividadinfo-tab" data-toggle="pill" href="#Actividadinfo" role="tab" aria-controls="Actividadinfo" aria-selected="true">Información</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" id="Cliente-tab" data-toggle="pill" href="#Cliente" role="tab" aria-controls="Cliente" aria-selected="false">Cliente</a>
                            </li>


                        </ul>


                    </div>

                    <div class="card-body">
                        <div class="tab-content" id="custom-tabs-one-tabContent">


                            <div class="tab-pane fade show active" id="Actividadinfo" role="tabpanel" aria-labelledby="Actividadinfo">
                                <div class="row">

                                    <div class="col-12 ">
                                        <label>Título</label>
                                        <p id="Titulo"></p>
                                        <input type="hidden" id="id_tarea" value="" />
                                    </div>

                                    <div class="col-6">
                                        <label>Tipo de Actividad</label>
                                        <p id="tipoActividad"></p>
                                    </div>
                                    <div class="col-6">
                                        <label>Complemento</label>
                                        <p id="complemento"></p>
                                    </div>
                                    <div class="col-6">
                                        <label>Fecha Desde</label>
                                        <p id="fecha_inicio"></p>
                                    </div>
                                    <div class="col-6">
                                        <label>Fecha Hasta</label>
                                        <p id="fecha_final"></p>
                                    </div>
                                </div>
                                <div class="col-12 ">
                                    <label>Observaciones/Respuesta</label>
                                    <textarea id="respuesta" class="form-control" rows="3" onkeyup="textCounter(this.id,'counter_respuesta',500)"></textarea>
                                    <label class="w-md-25 w-sm-50">
                                        <input id="counter_respuesta" class="form-control w-50" value="500" readonly />
                                    </label>
                                </div>
                                <a id="btn_actualizar" class="btn btn-primary"> Actualizar</a>
                            </div>
                            <div class="tab-pane fade" id="Cliente" role="tabpanel" aria-labelledby="Cliente">
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Cliente:</label>
                                    <p id="clienteAct"></p>

                                    <div class="row mt-2">

                                        <div class="col-6">
                                            <label class="d-block" for="exampleInputEmail1">Llamar:</label>

                                            <a class="text-white text-md mr-3 btn btn-success" href="#" onclick="llamada(); return false;"><i alt="LLamada" class="img-circle text-center mt-auto mb-auto img-circle fas fa-phone-alt"></i></a>

                                            <div class="">

                                            </div>

                                        </div>
                                        <div class="col-6">
                                            <label class="d-block" for="exampleInputEmail1">Correo:</label>
                                            <a class="text-md text-white btn btn-info" href="#" onclick="enviarCorreo(); return false;"><i alt="Correo" class="img-circle text-center  mt-auto mb-auto img-circle far fa-envelope"></i></a>

                                        </div>

                                        <div id="correoActividad" class="col-12 hidden">

                                            <label for="">Para:</label>
                                            <input type="email" class="form-control text-uppercase" id="confirmarCorreo" placeholder="correo@correo.com" value="">

                                            <a id="linkcorreo" href="#" class="btn btn-primary">Contactar</a>


                                        </div>
                                        <div id="llamadaActividad" class="col-12 hidden">


                                            <label for="exampleInputEmail1">Teléfono:</label>

                                            <input type="tel" class="form-control text-uppercase" id="confirmarTelefono" placeholder="99999999" value="">



                                            <a id="linkLlamar" href="#" class="btn btn-primary">llamar</a>

                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-body h500" id="x_cuerpo">

                    <div class="modal-footer mr-auto ml-auto" id="x_pie ">

                        <a class="btn btn-default" data-dismiss="modal" aria-label="Close">
                            <i class="fa fa-times "></i>
                            Cerrar
                        </a>
                        <a id_cronograma="" id_oportunidad="" tipo="" class="btn btn-success text-white" id="btn_realizado">
                            Marcar como Cerrado
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#tipoMoneda").val("MN");

        $('#confirmarCorreo').keyup(function () {
            var correo = $(this).val()
            $("#linkcorreo").attr("href", 'mailto:' + correo + '?Subject=');

        });
        $('#confirmarTelefono').keyup(function () {
            var telefono = $(this).val()
            $("#linkLlamar").attr("href", 'tel: ' + telefono + '');


        });
    });

    function llamada() {
        $('#llamadaActividad').removeClass('hidden');
        $('#correoActividad').addClass('hidden');
    };
    function enviarCorreo() {
        $('#correoActividad').removeClass('hidden');
        $('#llamadaActividad').addClass('hidden');
    };

    function textCounter(f, c, maxlimit) {
        var field = $("#" + f)[0];
        var countfield = $("#" + c)[0];
        if (field.value.length > maxlimit) {// if too long...trim it!
            field.value = field.value.substring(0, maxlimit);
            // otherwise, update 'characters left' counter
        } else {
            countfield.value = maxlimit - field.value.length;
        }
    }
    $(function () {

            $('.dropdown-menu a.dropdown-toggle').on('click', function (e) {
                if (!$(this).next().hasClass('show')) {
                    $(this).parents('.dropdown-menu').first().find('.show').removeClass('show');
                }
                var $subMenu = $(this).next('.dropdown-menu');
                $subMenu.toggleClass('show');


                $(this).parents('li.nav-item.dropdown.show').on('hidden.bs.dropdown', function (e) {
                    $('.dropdown-submenu .show').removeClass('show');
                });


                return false;
            });

        $('#cuerpo').on('click', '#actividad',function () {

            var id_cronograma = $(this).attr('id_cronograma');
            var idOportunidad = $(this).attr('idOportunidad');
            var tipo = $(this).attr('tipo');
            var data = { id_cronograma: id_cronograma, id_oportunidad: idOportunidad, tipo: tipo };
            $.ajax({
                url: "@Url.Content("~/Flujo/cargarActividad")",
                dataType: "json",
                data: data,
                type: 'GET',
                cache: false,
                success: function (data) {


                    $("#fecha_inicio").html("");
                    $("#fecha_final").html("");
                    $("#complemento").html("");
                    $("#tipoActividad").html("");
                    $("#Titulo").html("");
                    $("#clienteAct").html("");
                    $("#llamadaAct").html("");
                    $("#correoAct").html("");
                    $("#respuesta").val("");

                    $("#fecha_inicio").prepend(data.inicial);
                    $("#fecha_final").prepend(data.final);
                    $("#complemento").prepend(data.actividad[0].complemento);
                    $("#tipoActividad").prepend(data.actividad[0].Tipo_Actividad);
                    $("#Titulo").prepend(data.actividad[0].Titulo);
                    $("#respuesta").val(data.actividad[0].respuesta);
                    textCounter("respuesta", "counter_respuesta", 500)
                    $("#clienteAct").prepend(data.cliente[0].nombreCliente);
                    if (data.cliente[0].telefono != "") {
                        $("#confirmarTelefono").val(data.cliente[0].telefono);
                        $("#linkLlamar").attr("href", 'tel: ' + data.cliente[0].telefono + '');
                    }
                    if (data.cliente[0].correo != "") {
                        $("#confirmarCorreo").val(data.cliente[0].correo);
                        $("#linkcorreo").attr("href", 'mailto:' + data.cliente[0].correo + '');
                    }

                    if (data.actividad[0].estatus == 2) {
                        $("#modal_actividad .modal-header").attr('style', 'background: #dc3545; border-bottom-color: #dc3545;');
                        $("#modal_actividad .modal-header h1").removeClass('text-black-50');
                        $("#modal_actividad .modal-header h1").addClass('text-white');
                        $("#modal_actividad #respuesta").removeAttr('disabled');
                    }

                    if (data.actividad[0].estatus == 0) {
                        $("#modal_actividad .modal-header").attr('style', 'background: #fff; border-bottom-color: #fff;');
                        $("#modal_actividad .modal-header h1").addClass('text-black-50');
                        $("#modal_actividad .modal-header h1").removeClass('text-white');
                        $("#modal_actividad #respuesta").removeAttr('disabled');
                    }

                    $("#btn_realizado").attr('id_cronograma', data.actividad[0].Id_cronograma).attr('id_oportunidad', data.actividad[0].Id_oportunidad).attr('tipo', data.actividad[0].Tipo_Actividad);

                }

            });
        });
        $("#btn_actualizar").on('click', function () {
                    var id_cronograma = $("#btn_realizado").attr('id_cronograma');
                    var idOportunidad = $("#btn_realizado").attr('id_oportunidad');

                    var respuesta = $("#respuesta").val();

                    var data = { id_cronograma: id_cronograma, id_oportunidad: idOportunidad, respuesta: respuesta};
            $.ajax({
                url: "@Url.Content("~/Calendario/editarAsignadoCronograma")",
                dataType: "json",
                data: data,
                type: 'POST',
                success: function (datos) {


                    if (datos.Cambio == true) {

                        toastr.success('se actualizó con éxito.')

                    } else {
                        toastr.error('Algo salio mal.')
                    }
                    //cambiar por el otro modal



                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });
        });

        $("#cuerpo").on('change', 'select[name=Estado]', function () {


            //se agrega el campo de editar con la información del cliente
            var url = "@Url.Action("cambiarEstado", "Flujo")";
            var sourceId = $(this).val();
            var targetId = $(this).val();

            var idOportunidad = $(this).attr('idOportunidad');
            var data = { estadoInicial: sourceId, estadoFinal: targetId, idOportunidad: idOportunidad };


            $.ajax({
                url: url,
                data: data,
                type: 'POST',

                success: function (datos) {

                    toastr.success('Estado combiado con éxito.')
                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });








        });

        $("#btn_realizado").on('click', function () {
            var id_cronograma = $(this).attr('id_cronograma');
            var idOportunidad = $(this).attr('id_oportunidad');
            var tipo = $(this).attr('tipo');
            var respuesta = $("#respuesta").val();

            var data = { id_cronograma: id_cronograma, id_oportunidad: idOportunidad, tipo: tipo, respuesta: respuesta };
            $.ajax({
                url: "@Url.Content("~/Calendario/cambiarEstatusCronograma")",
                dataType: "json",
                data: data,
                type: 'POST',
                success: function (datos) {


                    if (datos.Cambio == true) {



                        window.location.href = "@Url.Content("~/Flujo/lista")";
                    } else {
                        toastr.error('Algo salio mal.')
                    }
                    //cambiar por el otro modal



                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });
        });

            $("#cuerpo").on('click', '.modal .card .card-header li a', function () {
        $(this).parent().parent().parent().find("a").each(function () {
            $(this).removeClass('active');
            $(this).attr("aria-selected", 'false');
        });



        var objetivo = $(this).attr("href");
        $(this).addClass('active');
        $(this).attr("aria-selected", 'true');

        $(this).parent().parent().parent().parent().parent().parent().find('[role=tabpanel]').each(function () {

            $(this).removeClass('active');
            $(this).removeClass('show');


        });

        $(this).parent().parent().parent().parent().parent().parent().find(objetivo).addClass('active');
        $(this).parent().parent().parent().parent().parent().parent().find(objetivo).addClass('show');
            });
        $('#btnModalOp').on('click', function () {
            cargarPotencial();
        });


        $('#range_5').ionRangeSlider({
            min: 0,
            max: 100,
            type: 'single',
            step: 1,
            postfix: ' %',
            prettify: false,
            hasGrid: true
        });

        $('.select2').select2();

           $("#m_nuevaOp").on('mouseenter', ".prioridad_estrella", function () {


        $(this).parent().find('#prio1').removeClass("fas fa-star");
        $(this).parent().find('#prio1').addClass("far fa-star");
        $(this).parent().find('#prio2').removeClass("fas fa-star");
        $(this).parent().find('#prio2').addClass("far fa-star");
        $(this).parent().find('#prio3').removeClass("fas fa-star");
        $(this).parent().find('#prio3').addClass("far fa-star");
        $(this).removeClass("fas fa-star");
        $(this).addClass("far fa-star");

        $(this).attr("style", "color: #000;");
        $(this).parent().find('#prio1').attr("style", "color: #000;");
        $(this).parent().find('#prio2').attr("style", "color: #000;");
        $(this).parent().find('#prio3').attr("style", "color: #000;");

        valor = $(this).attr("data-index");
        $(this).parent().find('#prioridad').attr("value", '0')
        if (valor == 1) {
            $(this).removeClass("far fa-star");
            $(this).addClass("fas fa-star");

            $(this).attr("style", "color: rgb(255, 149, 0)");
        }
        if (valor == 2) {
            $(this).parent().find('#prio1').removeClass("far fa-star");
            $(this).parent().find('#prio1').addClass("fas fa-star");
            $(this).removeClass("far fa-star");
            $(this).addClass("fas fa-star");

            $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
            $(this).attr("style", "color: rgb(255, 149, 0)");
        }
        if (valor == 3) {
            $(this).parent().find('#prio1').removeClass("far fa-star");
            $(this).parent().find('#prio1').addClass("fas fa-star");
            $(this).parent().find('#prio2').removeClass("far fa-star");
            $(this).parent().find('#prio2').addClass("fas fa-star");
            $(this).removeClass("far fa-star");
            $(this).addClass("fas fa-star");

            $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
            $(this).parent().find('#prio2').attr("style", "color: rgb(255, 149, 0)");
            $(this).attr("style", "color: rgb(255, 149, 0)");
        }
    });

    $("#m_nuevaOp").on('mouseleave', ".prioridad_estrella", function () {

        Prioridad = $(this).parent().find('#prioridad').attr("value");
        if (Prioridad == 0) {
            valor = $(this).attr("data-index");
            if (valor == 1) {
                $(this).removeClass("fas fa-star");
                $(this).addClass("far fa-star");

                $(this).attr("style", "color: #000;");
            }
            if (valor == 2) {
                $(this).parent().find('#prio1').removeClass("fas fa-star");
                $(this).parent().find('#prio1').addClass("far fa-star");
                $(this).removeClass("fas fa-star");
                $(this).addClass("far fa-star");

                $(this).attr("style", "color: #000;");
                $(this).parent().find('#prio1').attr("style", "color: #000;");

            }
            if (valor == 3) {
                $(this).parent().find('#prio1').removeClass("fas fa-star");
                $(this).parent().find('#prio1').addClass("far fa-star");
                $(this).parent().find('#prio2').removeClass("fas fa-star");
                $(this).parent().find('#prio2').addClass("far fa-star");
                $(this).removeClass("fas fa-star");
                $(this).addClass("far fa-star");

                $(this).attr("style", "color: #000;");
                $(this).parent().find('#prio1').attr("style", "color: #000;");
                $(this).parent().find('#prio2').attr("style", "color: #000;");
            }
        }


    });



        $("#m_nuevaOp").on('click', ".prioridad_estrella", function () {


            valor = $(this).attr("data-index");
            $(this).parent().find('#prioridad').attr("value", valor)

            if (valor == 1) {
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 2) {
                $(this).parent().find('#prio1').removeClass("far fa-star");
                $(this).parent().find('#prio1').addClass("fas fa-star");
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
            if (valor == 3) {
                $(this).parent().find('#prio1').removeClass("far fa-star");
                $(this).parent().find('#prio1').addClass("fas fa-star");
                $(this).parent().find('#prio2').removeClass("far fa-star");
                $(this).parent().find('#prio2').addClass("fas fa-star");
                $(this).removeClass("far fa-star");
                $(this).addClass("fas fa-star");

                $(this).parent().find('#prio1').attr("style", "color: rgb(255, 149, 0)");
                $(this).parent().find('#prio2').attr("style", "color: rgb(255, 149, 0)");
                $(this).attr("style", "color: rgb(255, 149, 0)");
            }
        });

         $('[name=Ingreso]').blur('input', function (event) {
            event.target.value = event.target.valueAsNumber.toFixed(2)
        });

        var idEstado = $(this).parent().parent().parent().parent().find(".estado").attr("id");
            var nomEstado = $(this).parent().parent().parent().parent().find(".card-titulo").html();
            $('input[name=idEstadoOp]').attr("value", idEstado);
            $('input[name=nombreEstado]').attr("value", nomEstado);


            $("input[name='tipoContacto']").change(function () {


                if (this.id == "ind_radio") {

                    $("#contenidoTipo").find('#tipo').val(0);
                    $("#contenidoTipo").find('#potencial').removeClass('hidden');
                    $("#contenidoTipo").find("#clientePot").attr('required', 'required')
                    $("#contenidoTipo").find("#clienteFi").removeAttr('required')
                    $("#contenidoTipo").find('#fidelizado').addClass('hidden');


                } else {

                    $("#contenidoTipo").find('#tipo').val(1);
                    $("#contenidoTipo").find('#fidelizado').removeClass('hidden');
                    $("#contenidoTipo").find("#clienteFi").attr('required', 'required')
                    $("#contenidoTipo").find("#clientePot").removeAttr('required')
                    $("#contenidoTipo").find('#potencial').addClass('hidden');

                }


            });

            $("#modal_crearPotencial").find('select[name=tipoDoc]').change(function () {
            var tipoDoc = $(this).val();


            if (tipoDoc == 1 || tipoDoc == 2 || tipoDoc == 3) {

                $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "hidden");

            } else {

                $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "text");


            }
        });

        //Para crear Contacto nuevo
    $("#cuerpo").on('click', "[id=agregarContacto]", function () {

        $(this).addClass('disabled')
        var cadena = `
                                                     <tr id="Nuevo">
                                                        <td class="align-middle columnaContacto">

                                                            <input type="text" class ="form-control form-control-sm mw-75 infoContacto" id="CONTACTO" name="CONTACTO">
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75 " id="AREA" name="AREA" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CARGO" name="CARGO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CORREO" name="CORREO" >
                                                        </td>
                                                        <td class="align-middle">
                                                            <input type="text" class ="form-control form-control-sm mw-75" id="TELEFONO" name="TELEFONO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="exampleInputPassword1" name="CELULAR" >
                                                        </td>

                                                        <td class ="align-middle">
                                                            <div class ="row justify-content-around text-center">
                                                                <div class ="col-auto">
                                                                    <a id="guardarNuevoContacto" class ="btn btn-xs btn-success"><i class ="fas fa-check text-white"></i></a>

                                                                </div>
                                                                <div class ="col-auto">

                                                                    <a id="removerNuevoContacto" class ="btn btn-xs btn-danger"><i class ="fas fa-times text-white"></i></a>
                                                                </div>

                                                            </div>
                                                        </td>
                                                    </tr>
                                `

        var CodCli = $(this).parent().find("table").attr('id');
        var tipoCliente = $(this).parent().find("table").attr('tipoCliente');
        var UltimoCod = $(this).parent().find('table tbody tr#guardado:last [name=COD_CONTACTO]').val();
        var Codigo = parseInt(UltimoCod) + parseInt("1");
        if (UltimoCod == null) {
            Codigo = 1;
        }

        $(this).parent().find('table tbody').append(cadena);

        $(this).parent().find("#removerNuevoContacto").click(function (event) { $(this).parent().parent().parent().parent().remove(); $("#cuerpo").find("#agregarContacto").removeClass('disabled'); });
        $(this).parent().find("#guardarNuevoContacto").click(function (event) {


            var paso = 1;
            var Cadena = `<tr id="guardado">`

            var dataNuevoContacto = "{COD_CLIENTE: '" + CodCli + "', COD_CONTACTO: '" + Codigo + "',";

            //recorre todos los input de contacto nuevo
            $(this).parent().parent().parent().parent().find("td [name]").each(function () {
                if ($(this).attr("name") == 'CONTACTO' && $(this).val() == '') {
                    toastr.warning("el campo contacto debe estar lleno");
                    paso = 0;
                } else {
                    //para crear la cadena a mostrar
                    if ($(this).attr("name") == 'CONTACTO') {
                        Cadena += `<td class ="align-middle"><p id="infoContacto" class="m-0">` + $(this).val() + `</p><input type="hidden" class ="form-control mw-75" id="COD_CLIENTE" name="COD_CLIENTE" value="` + CodCli + `">`;
                        Cadena += `<input type="hidden" class ="form-control mw-75 infoCli" id="tipoCli"  name="tipoCli" value="` + tipoCliente + `"><input type="hidden" class ="form-control mw-75" id="COD_CONTACTO" name="COD_CONTACTO" value="` + Codigo + `">`;
                        Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="exampleInputPassword1" name="CONTACTO" value="` + $(this).val() + `">`;
                        Cadena += `</td>`
                    } else {
                        Cadena += `<td class ="align-middle"><p id="infoContacto" class="m-0">` + $(this).val() + `</p>`;

                        Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="exampleInputPassword1" name="` + $(this).attr('name') + `" value="` + $(this).val() + `"></td>`

                    }
                    if ($(this).attr("name") == 'CELULAR') {
                        dataNuevoContacto += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                    } else {
                        dataNuevoContacto += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                    }
                }

            });

            dataNuevoContacto += "}";

            if (paso == 1) {
                if (tipoCliente == 0) {
                    var urlNuevoContacto = "@Url.Action("nuevoContactoPot", "Flujo")";
                    var json = eval("(" + dataNuevoContacto + ')');

                    $.post(urlNuevoContacto, json);


                    Cadena += `<td class ="align-middle"><div class ="row justify-content-around text-center"><div class ="col-auto"><a id="editarContacto" class="btn btn-xs btn-primary  pl-1 pr-1"><i class="fas fa-user-edit text-white"></i></a><a id="guardarEditado" class="btn btn-xs btn-success hidden"><i class="fas fa-check text-white"></i></a></div><div class ="col-auto"><a id="eliminarContacto" class ="btn btn-xs btn-danger"><i class ="far fa-trash-alt text-white"></i></a></div></div></td></tr>`



                    $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find('table tbody').append(Cadena);
                    $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find("#agregarContacto").removeClass('disabled');
                    $(this).parent().parent().parent().parent().remove();

                } else {
                    var urlNuevoContacto = "@Url.Action("nuevoContactoFi", "Flujo")";
                    var json = eval("(" + dataNuevoContacto + ')');

                    $.post(urlNuevoContacto, json);

                    Cadena += `<td class ="align-middle"><div class ="row justify-content-around text-center"><div class ="col-auto"><a id="editarContacto" class="btn btn-xs btn-primary  pl-1 pr-1"><i class="fas fa-user-edit text-white"></i></a><a id="guardarEditado" class="btn btn-xs btn-success hidden"><i class="fas fa-check text-white"></i></a></div><div class ="col-auto"><a id="eliminarContacto" class ="btn btn-xs btn-danger"><i class ="far fa-trash-alt text-white"></i></a></div></div></td></tr>`


                    $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find('table tbody').append(Cadena);
                    $(this).parent().parent().parent().parent().parent().parent().parent().parent().parent().parent().find("#agregarContacto").removeClass('disabled');
                    $(this).parent().parent().parent().parent().remove();
                }
            }
        });

    });

    //para editar cada contacto

    $("#cuerpo").on('click', '#formEditarCli tr td [id=guardarEditado]', function () {

        var paso = 1;
        var Cadena = `<tr id="guardado">`
        var CodCli = $(this).parent().parent().parent().parent().find("[name=COD_CLIENTE]").val()
        var Codigo = $(this).parent().parent().parent().parent().find("td [name=COD_CONTACTO]").val();
        var tipoCliente = $(this).parent().parent().parent().parent().find('[name=tipoCli]').val();
        var data = "{COD_CLIENTE: '" + CodCli + "', COD_CONTACTO: '" + Codigo + "',";

        //recorre todos los input de contacto nuevo
        $(this).parent().parent().parent().parent().find("td [name]").each(function () {
            if ($(this).attr("name") == 'CONTACTO' && $(this).val() == '') {
                alert("el campo contacto debe estar lleno");
                paso = 0;
            } else {
                //para crear la cadena a mostrar
                if ($(this).attr("name") == 'COD_CONTACTO' || $(this).attr("name") == 'COD_CLIENTE' || $(this).attr("name") == 'tipoCli') {

                } else {
                    $(this).parent().find('[id=infoContacto]').html($(this).val())
                    $(this).parent().find('[id=infoContacto]').removeClass('hidden')
                    $(this).attr('type', 'hidden');
                }
                if ($(this).attr("name") == 'CELULAR') {
                    data += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                } else {
                    data += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                }
            }
        });

        data += "}";

        if (paso == 1) {
            if (tipoCliente == 0) {
                var urlEditarContacto = "@Url.Action("editarContactoPot", "Flujo")";
                var json = eval("(" + data + ')');

                $.post(urlEditarContacto, json)


                $('#modal_editarClientePot').find('[id=guardarEditado]').addClass('hidden');
                $('#modal_editarClientePot').find('[id=editarContacto]').removeClass('hidden');
            } else {
                var urlEditarContacto = "@Url.Action("editarContactoFi", "Flujo")";
                var json = eval("(" + data + ')');

                $.post(urlEditarContacto, json)

                $('#modal_editarClienteFi').find('[id=guardarEditado]').addClass('hidden');
                $('#modal_editarClienteFi').find('[id=editarContacto]').removeClass('hidden');
            }

        }
    });

    //click al boton editar contacto

    $("#cuerpo").on('click', 'tr td [id=editarContacto]', function () {
        $(this).addClass('hidden');
        $(this).parent().find('#guardarEditado').removeClass('hidden');
        $(this).parent().parent().parent().parent().find("td").each(function () {
            $(this).find('p').addClass('hidden');
            if ($(this).find('.infoContacto').attr('name') == 'COD_CLIENTE' || $(this).find('.infoContacto').attr('name') == 'COD_CONTACTO') {

            } else {

                $(this).find('.infoContacto').attr('type', 'text');

            }

        });
        $(this).parent().parent().parent().parent().find('[name=CONTACTO]').attr('type', 'text');
    });


    //click al boton eliminar contacto

    $("#cuerpo").on('click', '#formEditarCli tr td [id=eliminarContacto]', function () {

        var CodCli = $(this).parent().parent().parent().parent().find("[name=COD_CLIENTE]").val()
        var Codigo = $(this).parent().parent().parent().parent().find("td [name=COD_CONTACTO]").val();
        var tipoCliente = $(this).parent().parent().parent().parent().find('[name=tipoCli]').val();
        var data = "{COD_CLIENTE:'" + CodCli + "', COD_CONTACTO:'" + Codigo + "'}";

        if (tipoCliente == 0) {
            var urlEliminarContacto = "@Url.Action("EliminarContactoPot", "Flujo")";
            var json = eval("(" + data + ')');
            var elemento = $(this);
            $.ajax({
                url: urlEliminarContacto,
                data: json,
                type: 'POST',

                success: function (datos) {

                    elemento.parent().parent().parent().parent().remove();

                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });




        } else {
            var urlEliminarContacto = "@Url.Action("EliminarContactoFi", "Flujo")";
            var json = eval("(" + data + ')');
            var elemento = $(this);
            $.ajax({
                url: urlEliminarContacto,
                data: json,
                type: 'POST',

                success: function (datos) {

                    elemento.parent().parent().parent().parent().remove();

                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });
        }


    });


        $("#cuerpo").on('change', 'select[name=clienteFi]', function () {

            $("#cuerpo").find("#modal_editarClienteFi").remove();
            //se agrega el campo de editar con la información del cliente
            var url = "@Url.Action("infoCliente", "Flujo")";
            var tipoCli = $("#contenidoTipo").find('#tipo').val();
            var codCli = $(this).val();
            var data = { cliente: codCli, tipoCli: tipoCli };



            $.ajax({
                url: url,
                data: data,
                type: 'POST',

                success: function (datos) {

                    $("#cuerpo").append(datos);

                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });


            $(this).parent().parent().attr("class", "col-11 p-0");
            $(this).parent().parent().parent().find("#editar").removeClass('hidden');







        });
        $("#cuerpo").on('change', 'select[name=clientePot]', function () {


            $("#cuerpo").find("#modal_editarClientePot").remove();
            //se agrega el campo de editar con la información del cliente
            var url = "@Url.Action("infoCliente", "Flujo")";
            var tipoCli = $("#contenidoTipo").find('#tipo').val();
            var codCli = $(this).val();
            var data = { cliente: codCli, tipoCli: tipoCli };



            $.ajax({
                url: url,
                data: data,
                type: 'POST',

                success: function (datos) {

                    $("#cuerpo").append(datos);

                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });


            $(this).parent().parent().attr("class", "col-11 p-0");
            $(this).parent().parent().parent().find("#editar").removeClass('hidden');







        });


    $("#cuerpo").on('click', '#modeditarClientePot', function () {


        $("#modal_editarClientePot").find('select[name=tipoDoc]').change(function () {
            var tipoDoc = $(this).val();


            if (tipoDoc == 1 || tipoDoc == 2 || tipoDoc == 3) {
                console.log('click')
                $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "text");
                $('#formCrearpot').find('[name=CSEGUNDO_NOMBRE]').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "hidden");
                console.log($('#formCrearpot').find('[name=CSEGUNDO_NOMBRE]'))
            } else {

                $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "hidden");
                $('#formCrearpot').find('[name=CSEGUNDO_NOMBRE]').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "text");


            }
        });
        var urlEditarPot = "@Url.Action("editarPot", "Flujo")";


        $("#modal_editarClientePot").on('click', '#editarCliente', function () {


            var dataEditar = "{";
            $("#formEditarCli").find(".infoCliente").each(function () {


                if ($(this).attr("name") == 'distrito') {
                    dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                } else {
                    dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                }

            });

            dataEditar += "}";
            console.log(dataEditar);
            var json = eval("(" + dataEditar + ')');

            $.ajax({
                url: urlEditarPot,
                data: json,
                type: 'POST',

                success: function (datos) {


                    toastr.success("se edito el cliente con éxito");

                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });


        });
    });

    $("#cuerpo").on('click', '#modeditarClienteFi', function () {


        $("#modal_editarClienteFi").find('select[name=tipoDoc]').change(function () {
            var tipoDoc = $(this).val();


            if (tipoDoc == 1 || tipoDoc == 2 || tipoDoc == 3) {

                $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "text");
                $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "hidden");

            } else {

                $(this).parent().parent().parent().parent().find('input#apPaterno').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#apMaterno').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#pNombre').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#sNombre').attr("type", "hidden");
                $(this).parent().parent().parent().parent().find('input#nombreCli').attr("type", "text");


            }
        });
        var urlEditarFi = "@Url.Action("editarFidelizado", "Flujo")";


        $("#modal_editarClienteFi").on('click', '#editarCliente', function () {


            var dataEditar = "{";
            $("#formEditarCli").find(".infoCliente").each(function () {


                if ($(this).attr("name") == 'distrito') {
                    dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "'";
                } else {
                    dataEditar += "" + $(this).attr("name") + ": '" + $(this).val() + "',";
                }

            });

            dataEditar += "}";
            console.log(dataEditar);
            var json = eval("(" + dataEditar + ')');
            $.ajax({
                url: urlEditarFi,
                data: json,
                type: 'POST',

                success: function (datos) {


                    toastr.success("se edito el cliente con éxito");

                },
                error: function (error) {
                    toastr.error('Algo salio mal.')

                },

            });


        });
    });
        //nuevo Contacto Cliente

    $("#modal_crearPotencial").find("#agregarContactoPot").click(function (event) {
        var CodCli = $("#modal_crearPotencial").find("[name=CCODCLI]").val();

        $(this).addClass('disabled')
        var cadena = `
                                                     <tr id="Nuevo">
                                                        <td class="align-middle columnaContacto">

                                                            <input type="text" class ="form-control form-control-sm mw-75 infoContacto" id="CONTACTO" name="CONTACTO">
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75 " id="AREA" name="AREA" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CARGO" name="CARGO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CORREO" name="CORREO" >
                                                        </td>
                                                        <td class="align-middle">
                                                            <input type="text" class ="form-control form-control-sm mw-75" id="TELEFONO" name="TELEFONO" >
                                                        </td>
                                                        <td class="align-middle">

                                                            <input type="text" class ="form-control form-control-sm mw-75" id="CELULAR" name="CELULAR" >
                                                        </td>

                                                        <td class ="align-middle">
                                                            <div class ="row justify-content-around text-center">
                                                                <div class ="col-auto">
                                                                    <a id="guardarNuevoContacto" class ="btn btn-xs btn-success"><i class ="fas fa-check text-white"></i></a>

                                                                </div>
                                                                <div class ="col-auto">

                                                                    <a id="removerNuevoContacto" class ="btn btn-xs btn-danger"><i class ="fas fa-times text-white"></i></a>
                                                                </div>

                                                            </div>
                                                        </td>
                                                    </tr>
                                `

        var CodCli = $("#agregarContactoPot").find("[name=CCODCLI]").val();
        var UltimoCod = $(this).parent().find('table tbody tr#guardado:last [name=COD_CONTACTO]').val();
        var Codigo = parseInt(UltimoCod) + parseInt("1");
        if (UltimoCod == null) {
            Codigo = 1;
        }

        $(this).parent().find('table tbody').append(cadena);



    });
    $("#modal_crearPotencial").on('click', "#removerNuevoContacto", function (event) { $("#modal_crearPotencial").find('table tbody tr#Nuevo').remove(); $("#modal_crearPotencial").find("#agregarContactoPot").removeClass('disabled'); });
    $("#modal_crearPotencial").on('click', "#eliminarContacto", function (event) { $(this).parent().parent().parent().parent().remove(); });
    $("#modal_crearPotencial").on('click', "#guardarNuevoContacto", function (event) {
        var CodCli = $("#modal_crearPotencial").find("[name=CCODCLI]").val();
        var UltimoCod = $("#modal_crearPotencial").find('table tbody tr#guardado:last [id=COD_CONTACTO]').val();
        var Codigo = parseInt(UltimoCod) + parseInt("1");
        if (UltimoCod == null) {
            Codigo = 1;
        }

        var paso = 1;
        var Cadena = `<tr id="guardado">`



        //recorre todos los input de contacto nuevo
        $(this).parent().parent().parent().parent().find("td [name]").each(function () {
            if ($(this).attr("id") == 'CONTACTO' && $(this).val() == '') {
                toastr.warning("el campo contacto debe estar lleno");
                paso = 0;
            } else {
                //para crear la cadena a mostrar
                if ($(this).attr("id") == 'CONTACTO') {
                    Cadena += `<td class ="align-middle"><p class="m-0" id="infoContacto">` + $(this).val() + `</p><input type="hidden" contacto="` + Codigo + `" class ="form-control mw-75 infoContacto" id="COD_CLIENTE" name="COD_CLIENTE" value="` + CodCli + `">`;
                    Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="COD_CONTACTO" contacto="` + Codigo + `" name="COD_CONTACTO" value="` + Codigo + `">`;
                    Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="CONTACTO" contacto="` + Codigo + `" name="CONTACTO" value="` + $(this).val() + `">`;
                    Cadena += `</td>`
                } else {
                    Cadena += `<td class ="align-middle"><p class="m-0" id="infoContacto">` + $(this).val() + `</p>`;

                    Cadena += `<input type="hidden" class ="form-control mw-75 infoContacto" id="` + $(this).attr('name') + `" contacto="` + Codigo + `" name="` + $(this).attr('name') + `" value="` + $(this).val() + `"></td>`

                }
            }

        });
        if (paso == 1) {


            Cadena += `<td class ="align-middle"><div class ="row justify-content-around text-center"><div class ="col-auto"><a id="editarContacto" class="btn btn-xs btn-primary  pl-1 pr-1"><i class="fas fa-user-edit text-white"></i></a><a id="guardarEditado" class="btn btn-xs btn-success hidden"><i class="fas fa-check text-white"></i></a></div><div class ="col-auto"><a id="eliminarContacto" class ="btn btn-xs btn-danger"><i class ="far fa-trash-alt text-white"></i></a></div></div></td></tr>`



            $("#modal_crearPotencial").find('table tbody tr#Nuevo').remove();
            $("#modal_crearPotencial").find('table tbody').append(Cadena);
            $("#modal_crearPotencial").find("#agregarContactoPot").removeClass('disabled');


        }
    });

    //para editar cada contacto
        $("#modal_crearPotencial").on('click', 'tr td [id=guardarEditado]', function () {
        var paso = 1;
        var Cadena = `<tr id="guardado">`
        var CodCli = $("#modal_editarCliente").find("[name=CCODCLI]").val()
        var Codigo = $(this).find("td [name=COD_CONTACTO]").val();

        //recorre todos los input de contacto nuevo
        $(this).parent().parent().parent().parent().find("td [name]").each(function () {
            if ($(this).attr("name") == 'CONTACTO' && $(this).val() == '') {
                toastr.warning("el campo contacto debe estar lleno");
                paso = 0;
            } else {
                //para crear la cadena a mostrar
                if ($(this).attr("name") == 'COD_CONTACTO' || $(this).attr("name") == 'COD_CLIENTE') {

                } else {
                    $(this).parent().find('[id=infoContacto]').html($(this).val())
                    $(this).parent().find('[id=infoContacto]').removeClass('hidden')
                    $(this).attr('type', 'hidden');
                }
            }
        });


        if (paso == 1) {

            $(this).addClass('hidden');
            $(this).parent().find('#editarContacto').removeClass('hidden')
        }
    });

    function cargarPotencial() {
        $.ajax({
            url: "@Url.Content("~/Flujo/cargarPotencial")",
            dataType: "json",
            type: 'GET',
            cache: false,
            success: function (data) {


                var potencial = $("#clientePot")[0];
                potencial.length = 0;


                for (i = 0; i < data.potencial.length; i++) {
                    potencial[i + 1] = new Option(data.potencial[i].CNOMCLI, data.potencial[i].CCODCLI, "", "");
                }
            }
        })
    };
        function cargarFidelizado() {
            $.ajax({
                url: "@Url.Content("~/Flujo/cargarFidelizado")",
                dataType: "json",
                type: 'GET',
                cache: false,
                success: function (data) {


                    var fidelizado = $("#clienteFi")[0];
                    fidelizado.length = 0;


                    for (i = 0; i < data.fidelizado.length; i++) {
                    fidelizado[i + 1] = new Option(data.fidelizado[i].CNOMCLI, data.fidelizado[i].CCODCLI, "", "");
                }
            }
        })
    };
    });

    //HILGER 030620
    function abrir_calendario(oportunidad) {
        var url = '@Url.Action("Index", "Calendario", new { propuestas = "asd" })';
        url = url.replace('asd', oportunidad);
        window.location.href = url;
    }
</script>
